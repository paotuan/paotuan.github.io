(function(e){function t(t){for(var r,n,a=t[0],c=t[1],l=t[2],p=0,m=[];p<a.length;p++)n=a[p],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&m.push(i[n][0]),i[n]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(m.length)m.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],r=!0,a=1;a<s.length;a++){var c=s[a];0!==i[c]&&(r=!1)}r&&(o.splice(t--,1),e=n(n.s=s[0]))}return e}var r={},i={app:0},o=[];function n(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=r,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;o.push([0,"vendors~app"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"018c":function(e,t){e.exports=VueClipboard},"0304":function(e,t,s){e.exports=s.p+"img/minacode.a2c8bc93.jpg"},"05b2":function(e,t,s){},"0716":function(e,t,s){"use strict";s("4eff")},"0c24":function(e,t,s){},"12a8":function(e,t,s){},"12d4":function(e,t,s){},"15aa":function(e,t,s){"use strict";s("8d6e")},2054:function(e,t,s){"use strict";s("fc3e")},2158:function(e,t,s){},2425:function(e,t,s){"use strict";s("4047")},"24c8":function(e,t,s){"use strict";s("e8d4")},"25f1":function(e,t,s){"use strict";s("fd5d")},2612:function(e,t,s){"use strict";s("9016")},2747:function(e,t,s){"use strict";s("362c")},"29bd":function(e,t,s){"use strict";s("3755")},"362c":function(e,t,s){},3755:function(e,t,s){},3763:function(e,t,s){"use strict";s("c964")},"37bd":function(e,t,s){},3838:function(e,t){e.exports=Random},"3dda":function(e,t,s){"use strict";s("05b2")},"3e62":function(e,t,s){"use strict";s("37bd")},4011:function(e,t,s){"use strict";s("7a62")},4047:function(e,t,s){},"413d":function(e,t,s){"use strict";s("824b")},"47b1":function(e,t,s){"use strict";s("9908")},"4bf3":function(e,t,s){},"4c27":function(e,t,s){"use strict";s("b322")},"4d06":function(e,t,s){"use strict";s("0c24")},"4eff":function(e,t,s){},5316:function(e,t,s){},"53b9":function(e,t,s){},5406:function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);var r=s("8bbf"),i=s.n(r),o=s("5f72"),n=s.n(o),a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"avatar",class:"circle"===e.shape?"shape-circle":""},[s("img",{attrs:{src:e.avatarSrc}})])},c=[],l=s("f6e3"),u=s.n(l),p={props:{src:String,type:{type:String,default:"C2C"},shape:{type:String,default:"circle"}},computed:{avatarSrc:function(){let e=this.src;return/^(https:|http:|\/\/)/.test(e)?e:this.defaultSrc},defaultSrc:function(){switch(this.type){case"C2C":return"https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png";case"GROUP":return"https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-3.png";case this.TIM.TYPES.CONV_SYSTEM:return u.a;default:return"https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-1.png"}}}},m=p,d=(s("691c"),s("2877")),h=Object(d["a"])(m,a,c,!1,null,"bd1b31fe",null),g=h.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"container",attrs:{"element-loading-text":"æ­£åœ¨æ‹¼å‘½åˆå§‹åŒ–...","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[e.isLogin?s("div",{staticClass:"chat-wrapper"},[s("el-row",[s("el-col",{attrs:{span:5}},[s("profile-bar"),s("side-bar")],1),s("el-col",{attrs:{span:19}},[s("current-conversation")],1)],1)],1):s("div",{attrs:{id:"wrapper"}},[s("login",{key:e.initialAppid,attrs:{"initial-appid":e.initialAppid,"initial-secret":e.initialSecret},on:{submit:e.doLogin}}),e._m(0)],1),s("image-previewer")],1)},b=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"meta"},[e._v("æ„è§/å»ºè®®å¯ç§»æ­¥ "),s("a",{attrs:{href:"https://github.com/paotuan/paotuan/issues",target:"_blank"}},[e._v("Github")]),e._v("ï¼Œæˆ–åŠ äº¤æµç¾¤ï¼š115699014")])}],v=(s("ac6a"),s("a481"),s("4917"),s("28a5"),s("bd86")),y=s("5880"),O=s.n(y),C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"current-conversation-wrapper"},[e.showCurrentConversation?s("div",{staticClass:"current-conversation",on:{scroll:e.onScroll}},[s("div",{staticClass:"header"},[s("div",{staticClass:"name"},[e._v(e._s(e.name))])]),s("div",{staticClass:"content"},[s("div",{ref:"message-list",staticClass:"message-list",on:{scroll:this.onScroll}},[e.isCompleted?s("div",{staticClass:"no-more"},[e._v("æ²¡æœ‰æ›´å¤šäº†")]):s("div",{staticClass:"more"},[s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$store.dispatch("getMessageList",e.currentConversation.conversationID)}}},[e._v("æŸ¥çœ‹æ›´å¤š")])],1),e._l(e.currentMessageList,(function(e){return s("message-item",{key:e.ID,attrs:{message:e}})}))],2),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowScrollButtomTips,expression:"isShowScrollButtomTips"}],staticClass:"newMessageTips",on:{click:e.scrollMessageListToButtom}},[e._v("å›åˆ°æœ€æ–°ä½ç½®")])]),e.showMessageSendBox?s("div",{staticClass:"footer"},[s("message-send-box")],1):e._e()]):e._e(),e.showConversationProfile?s("div",{staticClass:"profile"},[e.currentConversation.type===e.TIM.TYPES.CONV_GROUP?s("right-panel"):s("conversation-profile")],1):e._e(),s("member-profile-card")],1)},w=[],P=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{style:e.focus?{backgroundColor:"white"}:{},attrs:{id:"message-send-box-wrapper"},on:{drop:e.dropHandler}},[s("div",{staticClass:"send-header-bar"},[s("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"}},[s("div",{staticClass:"emojis"},e._l(e.emojiName,(function(t){return s("div",{key:t,staticClass:"emoji",on:{click:function(s){return e.chooseEmoji(t)}}},[s("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:e.emojiUrl+e.emojiMap[t]}})])})),0),s("i",{staticClass:"iconfont icon-smile",attrs:{slot:"reference",title:"å‘è¡¨æƒ…"},slot:"reference"})]),s("i",{staticClass:"iconfont icon-tupian",attrs:{title:"å‘å›¾ç‰‡"},on:{click:e.handleSendImageClick}}),s("i",{staticClass:"el-icon-camera",attrs:{title:"å‘è§†é¢‘"},on:{click:e.handleSendVideoClick}}),s("i",{staticClass:"iconfont icon-wenjian",attrs:{title:"å‘æ–‡ä»¶"},on:{click:e.handleSendFileClick}}),s("i",{staticClass:"el-icon-warning-outline",attrs:{title:"éª°å­æŒ‡å—"},on:{click:function(t){e.showDiceUsageVisible=!0}}})],1),s("el-dialog",{attrs:{title:"ğŸ² å¦‚ä½•ä½¿ç”¨éª°å­",visible:e.showDiceUsageVisible,width:"40%"},on:{"update:visible":function(t){e.showDiceUsageVisible=t}}},[s("div",{staticClass:"dice-usage"},[s("div",[e._v("é¦–å…ˆè¯·ç¡®ä¿ç¾¤ä¸»å¯ç”¨äº†ç¾¤æœºå™¨äººã€‚åœ¨å¯ç”¨æœºå™¨äººåï¼Œæœºå™¨äººä¼šå¯¹ç¾¤é‡Œçš„éª°å­æŒ‡ä»¤åšå‡ºå“åº”ã€‚")]),s("div",[e._v("éª°å­æŒ‡ä»¤ä»¥å°æ•°ç‚¹å¼€å¤´ï¼ˆä¸­æ–‡å¥å·äº¦å¯ï¼‰ï¼Œæ¥ä¸€ä¸ªåˆæ³•çš„éª°å­è¡¨è¾¾å¼ã€‚æœºå™¨äººæ”¯æŒå¤šç§å¸¸è§çš„éª°å­è¡¨è¾¾å¼ï¼Œæœ‰å…³è¡¨è¾¾å¼çš„ç»†èŠ‚å¯ä»¥\n          "),s("el-link",{staticClass:"inline-link",attrs:{type:"primary",href:"https://greenimp.github.io/rpg-dice-roller/guide/notation/",target:"_blank",underline:!1}},[e._v("å‚è€ƒè¯¦ç»†æ–‡æ¡£")]),e._v("ã€‚\n        ")],1),s("div",[e._v("å¸¸ç”¨æŒ‡ä»¤ï¼š")]),s("ul",[s("li",[e._v("åŸºç¡€éª°å­ï¼š"),s("span",[e._v(".d6")]),e._v(" â†’ æŠ•æ·ä¸€ä¸ªå…­é¢éª°ï¼ˆéª°å­é¢æ•°å¯æ›¿æ¢ä¸ºä»»æ„æ•°å­—ï¼‰")]),s("li",[e._v("ç™¾åˆ†éª°ï¼š"),s("span",[e._v(".d%")]),e._v(" â†’ æŠ•æ·ä¸€ä¸ªç™¾åˆ†éª°ï¼Œç­‰åŒäº "),s("span",[e._v(".d100")])]),s("li",[e._v("éª°å­ç»„åˆï¼š"),s("span",[e._v(".2d6+d4")]),e._v(" â†’ æŠ•æ·ä¸¤ä¸ªå…­é¢éª°å’Œä¸€ä¸ªå››é¢éª°ï¼ˆæ”¯æŒåŒæ—¶å¤šä¸ªéª°å­å’ŒåŸºç¡€è¿ç®—ï¼‰")]),s("li",[e._v("COC å¥–åŠ±éª°ï¼š"),s("span",[e._v(".2d%kl1")]),e._v(" â†’ æŠ•æ·ä¸¤ä¸ªç™¾åˆ†éª°ï¼Œå¹¶ä¿ç•™ï¼ˆ"),s("b",[e._v("k")]),e._v("eepï¼‰æœ€ä½ï¼ˆ"),s("b",[e._v("l")]),e._v("owestï¼‰çš„ä¸€ä¸ª")]),s("li",[e._v("Fate éª°å­ï¼š"),s("span",[e._v(".4dF")]),e._v(" â†’ æŠ•æ·å››ä¸ª Fate è§„åˆ™çš„éª°å­")])]),s("div",[e._v("åœ¨éª°å­è¡¨è¾¾å¼åé¢å¯ä»¥æ¥ä¸ŠåŠ¨ä½œçš„æè¿°ï¼Œä»¥å¢å¼ºæŒ‡ä»¤çš„å¯è¯»æ€§ï¼Œå¹¶å¯ä»¥ä¸äººç‰©å¡è”åŠ¨ï¼Œä¾‹å¦‚ "),s("span",[e._v(".d% è†å¬")]),e._v(" ã€‚")])])]),s("el-popover",{staticStyle:{"max-height":"500px","overflow-y":"scroll"},attrs:{trigger:"manual",placement:"top"},model:{value:e.showAtGroupMember,callback:function(t){e.showAtGroupMember=t},expression:"showAtGroupMember"}},e._l(e.memberList,(function(t){return s("el-radio-group",{key:t.userID,staticStyle:{display:"flex","flex-decoration":"column"},on:{change:e.handleSelectAtUser},model:{value:e.atUserID,callback:function(t){e.atUserID=t},expression:"atUserID"}},[s("el-radio",{attrs:{label:t.userID}},[e._v(e._s(t.nameCard||t.nick||t.userID))])],1)})),1),s("div",{staticClass:"bottom"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageContent,expression:"messageContent"}],ref:"text-input",staticClass:"text-input",attrs:{rows:"4",resize:"false"},domProps:{value:e.messageContent},on:{focus:function(t){e.focus=!0},blur:function(t){e.focus=!1},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.handleEnter(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.stopPropagation(),e.handleUp(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.stopPropagation(),e.handleDown(t))}],keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?(t.preventDefault(),t.shiftKey||t.altKey||t.metaKey?null:e.handleLine(t)):null},input:function(t){t.target.composing||(e.messageContent=t.target.value)}}}),s("ghost-message-send-box",{attrs:{"to-account":e.toAccount,"current-conversation-type":e.currentConversationType}}),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"æŒ‰Enterå‘é€æ¶ˆæ¯ï¼ŒCtrl+Enteræ¢è¡Œ",placement:"left-start"}},[s("div",{staticClass:"btn-send",on:{click:e.sendTextMessage}},[s("div",{staticClass:"tim-icon-send"})])])],1),s("input",{ref:"imagePicker",staticStyle:{display:"none"},attrs:{type:"file",id:"imagePicker",accept:".jpg, .jpeg, .png, .gif, .bmp"},on:{change:e.sendImage}}),s("input",{ref:"filePicker",staticStyle:{display:"none"},attrs:{type:"file",id:"filePicker"},on:{change:e.sendFile}}),s("input",{ref:"videoPicker",staticStyle:{display:"none"},attrs:{type:"file",id:"videoPicker",accept:".mp4"},on:{change:e.sendVideo}})],1)},_=[];s("fe90");const M="https://imgcache.qq.com/open/qcloud/tim/assets/emoji/",I={"[NO]":"emoji_0@2x.png","[OK]":"emoji_1@2x.png","[ä¸‹é›¨]":"emoji_2@2x.png","[ä¹ˆä¹ˆå“’]":"emoji_3@2x.png","[ä¹’ä¹“]":"emoji_4@2x.png","[ä¾¿ä¾¿]":"emoji_5@2x.png","[ä¿¡å°]":"emoji_6@2x.png","[å·ç¬‘]":"emoji_7@2x.png","[å‚²æ…¢]":"emoji_8@2x.png","[å†è§]":"emoji_9@2x.png","[å†·æ±—]":"emoji_10@2x.png","[å‡‹è°¢]":"emoji_11@2x.png","[åˆ€]":"emoji_12@2x.png","[åˆ é™¤]":"emoji_13@2x.png","[å‹¾å¼•]":"emoji_14@2x.png","[å‘å‘†]":"emoji_15@2x.png","[å‘æŠ–]":"emoji_16@2x.png","[å¯æ€œ]":"emoji_17@2x.png","[å¯çˆ±]":"emoji_18@2x.png","[å³å“¼å“¼]":"emoji_19@2x.png","[å³å¤ªæ]":"emoji_20@2x.png","[å³è½¦å¤´]":"emoji_21@2x.png","[å]":"emoji_22@2x.png","[å“]":"emoji_23@2x.png","[å’’éª‚]":"emoji_24@2x.png","[å’–å•¡]":"emoji_25@2x.png","[å•¤é…’]":"emoji_26@2x.png","[å˜˜]":"emoji_27@2x.png","[å›å¤´]":"emoji_28@2x.png","[å›°]":"emoji_29@2x.png","[åç¬‘]":"emoji_30@2x.png","[å¤šäº‘]":"emoji_31@2x.png","[å¤§å…µ]":"emoji_32@2x.png","[å¤§å“­]":"emoji_33@2x.png","[å¤ªé˜³]":"emoji_34@2x.png","[å¥‹æ–—]":"emoji_35@2x.png","[å¥¶ç“¶]":"emoji_36@2x.png","[å§”å±ˆ]":"emoji_37@2x.png","[å®³ç¾]":"emoji_38@2x.png","[å°´å°¬]":"emoji_39@2x.png","[å·¦å“¼å“¼]":"emoji_40@2x.png","[å·¦å¤ªæ]":"emoji_41@2x.png","[å·¦è½¦å¤´]":"emoji_42@2x.png","[å·®åŠ²]":"emoji_43@2x.png","[å¼±]":"emoji_44@2x.png","[å¼º]":"emoji_45@2x.png","[å½©å¸¦]":"emoji_46@2x.png","[å½©çƒ]":"emoji_47@2x.png","[å¾—æ„]":"emoji_48@2x.png","[å¾®ç¬‘]":"emoji_49@2x.png","[å¿ƒç¢äº†]":"emoji_50@2x.png","[å¿«å“­äº†]":"emoji_51@2x.png","[æ€„ç«]":"emoji_52@2x.png","[æ€’]":"emoji_53@2x.png","[æƒŠæ]":"emoji_54@2x.png","[æƒŠè®¶]":"emoji_55@2x.png","[æ†¨ç¬‘]":"emoji_56@2x.png","[æ‰‹æª]":"emoji_57@2x.png","[æ‰“å“ˆæ¬ ]":"emoji_58@2x.png","[æŠ“ç‹‚]":"emoji_59@2x.png","[æŠ˜ç£¨]":"emoji_60@2x.png","[æŠ é¼»]":"emoji_61@2x.png","[æŠ±æŠ±]":"emoji_62@2x.png","[æŠ±æ‹³]":"emoji_63@2x.png","[æ‹³å¤´]":"emoji_64@2x.png","[æŒ¥æ‰‹]":"emoji_65@2x.png","[æ¡æ‰‹]":"emoji_66@2x.png","[æ’‡å˜´]":"emoji_67@2x.png","[æ“¦æ±—]":"emoji_68@2x.png","[æ•²æ‰“]":"emoji_69@2x.png","[æ™•]":"emoji_70@2x.png","[æœˆäº®]":"emoji_71@2x.png","[æ£’æ£’ç³–]":"emoji_72@2x.png","[æ±½è½¦]":"emoji_73@2x.png","[æ²™å‘]":"emoji_74@2x.png","[æµæ±—]":"emoji_75@2x.png","[æµæ³ª]":"emoji_76@2x.png","[æ¿€åŠ¨]":"emoji_77@2x.png","[ç¯æ³¡]":"emoji_78@2x.png","[ç‚¸å¼¹]":"emoji_79@2x.png","[ç†ŠçŒ«]":"emoji_80@2x.png","[çˆ†ç­‹]":"emoji_81@2x.png","[çˆ±ä½ ]":"emoji_82@2x.png","[çˆ±å¿ƒ]":"emoji_83@2x.png","[çˆ±æƒ…]":"emoji_84@2x.png","[çŒªå¤´]":"emoji_85@2x.png","[çŒ«å’ª]":"emoji_86@2x.png","[çŒ®å»]":"emoji_87@2x.png","[ç«ç‘°]":"emoji_88@2x.png","[ç“¢è™«]":"emoji_89@2x.png","[ç–‘é—®]":"emoji_90@2x.png","[ç™½çœ¼]":"emoji_91@2x.png","[çš®çƒ]":"emoji_92@2x.png","[ç¡è§‰]":"emoji_93@2x.png","[ç£•å¤´]":"emoji_94@2x.png","[ç¤ºçˆ±]":"emoji_95@2x.png","[ç¤¼å“è¢‹]":"emoji_96@2x.png","[ç¤¼ç‰©]":"emoji_97@2x.png","[ç¯®çƒ]":"emoji_98@2x.png","[ç±³é¥­]":"emoji_99@2x.png","[ç³—å¤§äº†]":"emoji_100@2x.png","[çº¢åŒå–œ]":"emoji_101@2x.png","[çº¢ç¯ç¬¼]":"emoji_102@2x.png","[çº¸å·¾]":"emoji_103@2x.png","[èƒœåˆ©]":"emoji_104@2x.png","[è‰²]":"emoji_105@2x.png","[è¯]":"emoji_106@2x.png","[èœåˆ€]":"emoji_107@2x.png","[è›‹ç³•]":"emoji_108@2x.png","[èœ¡çƒ›]":"emoji_109@2x.png","[è¡—èˆ]":"emoji_110@2x.png","[è¡°]":"emoji_111@2x.png","[è¥¿ç“œ]":"emoji_112@2x.png","[è°ƒçš®]":"emoji_113@2x.png","[è±¡æ£‹]":"emoji_114@2x.png","[è·³ç»³]":"emoji_115@2x.png","[è·³è·³]":"emoji_116@2x.png","[è½¦å¢]":"emoji_117@2x.png","[è½¬åœˆ]":"emoji_118@2x.png","[é„™è§†]":"emoji_119@2x.png","[é…·]":"emoji_120@2x.png","[é’ç¥¨]":"emoji_121@2x.png","[é’»æˆ’]":"emoji_122@2x.png","[é—ªç”µ]":"emoji_123@2x.png","[é—­å˜´]":"emoji_124@2x.png","[é—¹é’Ÿ]":"emoji_125@2x.png","[é˜´é™©]":"emoji_126@2x.png","[éš¾è¿‡]":"emoji_127@2x.png","[é›¨ä¼]":"emoji_128@2x.png","[é’è›™]":"emoji_129@2x.png","[é¢æ¡]":"emoji_130@2x.png","[é­ç‚®]":"emoji_131@2x.png","[é£è½¦]":"emoji_132@2x.png","[é£å»]":"emoji_133@2x.png","[é£æœº]":"emoji_134@2x.png","[é¥¥é¥¿]":"emoji_135@2x.png","[é¦™è•‰]":"emoji_136@2x.png","[éª·é«…]":"emoji_137@2x.png","[éº¦å…‹é£]":"emoji_138@2x.png","[éº»å°†]":"emoji_139@2x.png","[é¼“æŒ]":"emoji_140@2x.png","[é¾‡ç‰™]":"emoji_141@2x.png"},j=["[é¾‡ç‰™]","[è°ƒçš®]","[æµæ±—]","[å·ç¬‘]","[å†è§]","[æ•²æ‰“]","[æ“¦æ±—]","[çŒªå¤´]","[ç«ç‘°]","[æµæ³ª]","[å¤§å“­]","[å˜˜]","[é…·]","[æŠ“ç‹‚]","[å§”å±ˆ]","[ä¾¿ä¾¿]","[ç‚¸å¼¹]","[èœåˆ€]","[å¯çˆ±]","[è‰²]","[å®³ç¾]","[å¾—æ„]","[å]","[å¾®ç¬‘]","[æ€’]","[å°´å°¬]","[æƒŠæ]","[å†·æ±—]","[çˆ±å¿ƒ]","[ç¤ºçˆ±]","[ç™½çœ¼]","[å‚²æ…¢]","[éš¾è¿‡]","[æƒŠè®¶]","[ç–‘é—®]","[å›°]","[ä¹ˆä¹ˆå“’]","[æ†¨ç¬‘]","[çˆ±æƒ…]","[è¡°]","[æ’‡å˜´]","[é˜´é™©]","[å¥‹æ–—]","[å‘å‘†]","[å³å“¼å“¼]","[æŠ±æŠ±]","[åç¬‘]","[é£å»]","[é„™è§†]","[æ™•]","[å¤§å…µ]","[å¯æ€œ]","[å¼º]","[å¼±]","[æ¡æ‰‹]","[èƒœåˆ©]","[æŠ±æ‹³]","[å‡‹è°¢]","[ç±³é¥­]","[è›‹ç³•]","[è¥¿ç“œ]","[å•¤é…’]","[ç“¢è™«]","[å‹¾å¼•]","[OK]","[çˆ±ä½ ]","[å’–å•¡]","[æœˆäº®]","[åˆ€]","[å‘æŠ–]","[å·®åŠ²]","[æ‹³å¤´]","[å¿ƒç¢äº†]","[å¤ªé˜³]","[ç¤¼ç‰©]","[çš®çƒ]","[éª·é«…]","[æŒ¥æ‰‹]","[é—ªç”µ]","[é¥¥é¥¿]","[å’’éª‚]","[æŠ˜ç£¨]","[æŠ é¼»]","[é¼“æŒ]","[ç³—å¤§äº†]","[å·¦å“¼å“¼]","[æ‰“å“ˆæ¬ ]","[å¿«å“­äº†]","[å“]","[ç¯®çƒ]","[ä¹’ä¹“]","[NO]","[è·³è·³]","[æ€„ç«]","[è½¬åœˆ]","[ç£•å¤´]","[å›å¤´]","[è·³ç»³]","[æ¿€åŠ¨]","[è¡—èˆ]","[çŒ®å»]","[å·¦å¤ªæ]","[å³å¤ªæ]","[é—­å˜´]","[çŒ«å’ª]","[çº¢åŒå–œ]","[é­ç‚®]","[çº¢ç¯ç¬¼]","[éº»å°†]","[éº¦å…‹é£]","[ç¤¼å“è¢‹]","[ä¿¡å°]","[è±¡æ£‹]","[å½©å¸¦]","[èœ¡çƒ›]","[çˆ†ç­‹]","[æ£’æ£’ç³–]","[å¥¶ç“¶]","[é¢æ¡]","[é¦™è•‰]","[é£æœº]","[å·¦è½¦å¤´]","[è½¦å¢]","[å³è½¦å¤´]","[å¤šäº‘]","[ä¸‹é›¨]","[é’ç¥¨]","[ç†ŠçŒ«]","[ç¯æ³¡]","[é£è½¦]","[é—¹é’Ÿ]","[é›¨ä¼]","[å½©çƒ]","[é’»æˆ’]","[æ²™å‘]","[çº¸å·¾]","[æ‰‹æª]","[é’è›™]"];var T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"ghost",staticStyle:{display:"none"},attrs:{id:"ghost-message-send-box"},on:{click:e.send}})},E=[],S={props:["toAccount","currentConversationType"],methods:{send(){const e=this.$refs.ghost.innerText;if(0===e.trim().length)return;const t=this.tim.createTextMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{text:e}});this.$store.commit("pushCurrentMessageList",t),this.$bus.$emit("scroll-bottom"),this.tim.sendMessage(t).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})}),this.$refs.ghost.innerText=""}}},D=S,x=Object(d["a"])(D,T,E,!1,null,null,null),k=x.exports;function A(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function G(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?A(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):A(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var $={name:"message-send-box",props:["scrollMessageListToButtom"],components:{ElInput:o["Input"],ElForm:o["Form"],ElFormItem:o["FormItem"],ElDialog:o["Dialog"],ElPopover:o["Popover"],ElRadioGroup:o["RadioGroup"],ElRadio:o["Radio"],ElTooltip:o["Tooltip"],ElRate:o["Rate"],GhostMessageSendBox:k},data(){return{callingList:[],callingType:"",showCallingMember:!1,colors:["#99A9BF","#F7BA2A","#FF9900"],messageContent:"",isSendCustomMessage:!1,sendCustomDialogVisible:!1,surveyDialogVisible:!1,showDiceUsageVisible:!1,form:{data:"",description:"",extension:""},rate:5,suggestion:"",file:"",emojiMap:I,emojiName:j,emojiUrl:M,showAtGroupMember:!1,atUserID:"",focus:!1}},computed:G(G({},Object(y["mapGetters"])(["toAccount","currentConversationType"])),Object(y["mapState"])({memberList:e=>e.group.currentMemberList,userID:e=>e.user.userID,groupProfile:e=>e.conversation.currentConversation.groupProfile})),mounted(){this.$refs["text-input"].addEventListener("paste",this.handlePaste),this.$bus.$on("reEditMessage",this.reEditMessage)},beforeDestroy(){this.$refs["text-input"].removeEventListener("paste",this.handlePaste)},methods:{getList(e){this.callingList=e},cancelCalling(){this.showCallingMember=!1},callingHandler(){if(this.callingList.length<1)return void this.$store.commit("showMessage",{type:"warning",message:"è¯·é€‰æ‹©æˆå‘˜"});this.showCallingMember=!1;let e={memberList:this.callingList,type:this.TIM.TYPES.CONV_GROUP};this.$store.commit("setCallingList",e),"video"!==this.callingType?"audio"!==this.callingType||this.$bus.$emit("audio-call"):this.$bus.$emit("video-call")},trtcCalling(e){if("video"===e&&(this.callingType="video"),"audio"===e&&(this.callingType="audio"),"C2C"===this.currentConversationType){let t=[this.toAccount],s={memberList:t,type:"C2C"};return this.$store.commit("setCallingList",s),void this.$bus.$emit(e+"-call")}this.currentConversationType===this.TIM.TYPES.CONV_GROUP&&(this.showCallingMember=!0)},audioCall(){this.$bus.$emit("audio-call"),this.$store.commit("showAudioCall",!0)},handleEmojiShow(){this.emojiShow=!0,this.bigEmojiShow=!1},handleBigEmojiShow(e){let t=document.getElementById("bigEmojiBox");t&&(t.scrollTop=0),this.curItemIndex=e,this.curBigEmojiItemList=this.bigEmojiList[e].list,this.emojiShow=!1,this.bigEmojiShow=!0},chooseBigEmoji(e){this.popoverVisible=!1;let t=this.tim.createFaceMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{index:this.curItemIndex+1,data:e+"@2x"}});this.$store.commit("pushCurrentMessageList",t),this.$bus.$emit("scroll-bottom"),this._sendMessage(t).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},reEditMessage(e){this.messageContent=e},handleSelectAtUser(){this.messageContent+=this.atUserID+" ",this.showAtGroupMember=!1},handleUp(){const e=this.memberList.findIndex(e=>e.userID===this.atUserID);e-1<0||(this.atUserID=this.memberList[e-1].userID)},handleDown(){const e=this.memberList.findIndex(e=>e.userID===this.atUserID);e+1>=this.memberList.length||(this.atUserID=this.memberList[e+1].userID)},handleEnter(){this.showAtGroupMember?this.handleSelectAtUser():this.sendTextMessage()},handleLine(){this.messageContent+="\n"},handlePaste(e){let t,s=e.clipboardData;if(s&&s.files&&s.files.length>0&&(t=s.files[0]),"undefined"===typeof t)return;let r=this.tim.createImageMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:t},onProgress:e=>{this.$set(r,"progress",e)}});this.$store.commit("pushCurrentMessageList",r);let i=this._sendMessage(r);i.catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},dropHandler(e){e.preventDefault();let t=e.dataTransfer.files[0],s={};s="video/mp4"===t.type?this.tim.createVideoMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:t},onProgress:e=>{this.$set(s,"progress",e)}}):this.tim.createFileMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:t},onProgress:e=>{this.$set(s,"progress",e)}}),this.$store.commit("pushCurrentMessageList",s),this._sendMessage(s).then(()=>{this.$refs.videoPicker.value=null}).catch(e=>{this.$store.commit("showMessage",{message:e.message,type:"error"})})},sendTextMessage(){if(""===this.messageContent||0===this.messageContent.trim().length)return this.messageContent="",void this.$store.commit("showMessage",{message:"ä¸èƒ½å‘é€ç©ºæ¶ˆæ¯å“¦ï¼",type:"info"});const e=this.tim.createTextMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{text:this.messageContent}});this.$store.commit("pushCurrentMessageList",e),this.$bus.$emit("scroll-bottom"),this._sendMessage(e).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})}),this.messageContent=""},sendCustomMessage(){if(0===this.form.data.length&&0===this.form.description.length&&0===this.form.extension.length)return void this.$store.commit("showMessage",{message:"ä¸èƒ½å‘é€ç©ºæ¶ˆæ¯",type:"info"});const e=this.tim.createCustomMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{data:this.form.data,description:this.form.description,extension:this.form.extension}});this.$store.commit("pushCurrentMessageList",e),this._sendMessage(e).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})}),Object.assign(this.form,{data:"",description:"",extension:""}),this.sendCustomDialogVisible=!1},random(e,t){return Math.floor(Math.random()*(t-e+1)+e)},sendSurvey(){const e=this.tim.createCustomMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{data:"survey",description:String(this.rate),extension:this.suggestion}});this.$store.commit("pushCurrentMessageList",e),Object.assign(this.form,{data:"",description:"",extension:""}),this._sendMessage(e).then(()=>{Object.assign(this,{rate:5,suggestion:""})}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})}),this.surveyDialogVisible=!1},chooseEmoji(e){this.messageContent+=e},handleSendImageClick(){this.$refs.imagePicker.click()},handleSendFileClick(){this.$refs.filePicker.click()},handleSendVideoClick(){this.$refs.videoPicker.click()},groupLive(){this.$store.commit("updateGroupLiveInfo",{groupID:this.toAccount,anchorID:this.userID}),this.$bus.$emit("open-group-live",{channel:1})},sendImage(){const e=this.tim.createImageMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:document.getElementById("imagePicker")},onProgress:t=>{this.$set(e,"progress",t)}});this.$store.commit("pushCurrentMessageList",e),this._sendMessage(e).then(()=>{this.$refs.imagePicker.value=null}).catch(e=>{this.$store.commit("showMessage",{message:e.message,type:"error"})})},sendFile(){const e=this.tim.createFileMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:document.getElementById("filePicker")},onProgress:t=>{this.$set(e,"progress",t)}});this.$store.commit("pushCurrentMessageList",e),this._sendMessage(e).then(()=>{this.$refs.filePicker.value=null}).catch(e=>{this.$store.commit("showMessage",{message:e.message,type:"error"})})},sendVideo(){const e=this.tim.createVideoMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:document.getElementById("videoPicker")},onProgress:t=>{this.$set(e,"progress",t)}});this.$store.commit("pushCurrentMessageList",e),this._sendMessage(e).then(()=>{this.$refs.videoPicker.value=null}).catch(e=>{this.$store.commit("showMessage",{message:e.message,type:"error"})})},_sendMessage(e){return this.tim.sendMessage(e).then(t=>(this.$store.dispatch("insertGameLogs",[e]),t))}}},L=$,R=(s("b7a8"),Object(d["a"])(L,P,_,!1,null,"2f16a6f4",null)),N=R.exports,U=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-wrapper",class:e.messagePosition},[e.currentConversationType===e.TIM.TYPES.CONV_C2C?s("div",{staticClass:"c2c-layout",class:e.messagePosition},[e.showAvatar?s("div",{staticClass:"col-1"},[s("avatar",{attrs:{src:e.avatar}})],1):e._e(),s("div",{staticClass:"col-2"},[s("div",{staticClass:"content-wrapper"},[e.isMine?s("message-status-icon",{attrs:{message:e.message}}):e._e(),e.message.type===e.TIM.TYPES.MSG_TEXT?s("text-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_IMAGE?s("image-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_FILE?s("file-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_SOUND?s("sound-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_GRP_TIP?s("group-tip-element",{attrs:{payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_GRP_SYS_NOTICE?s("group-system-notice-element",{attrs:{payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_CUSTOM?s("custom-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_FACE?s("face-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_VIDEO?s("video-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_GEO?s("geo-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):s("span",[e._v("æš‚æœªæ”¯æŒçš„æ¶ˆæ¯ç±»å‹ï¼š"+e._s(e.message.type))])],1),e.showMessageHeader?s("message-footer",{attrs:{message:e.message}}):e._e()],1),s("div",{staticClass:"col-3"})]):e._e(),e.currentConversationType===e.TIM.TYPES.CONV_GROUP?s("div",{staticClass:"group-layout",class:e.messagePosition},[e.showAvatar?s("div",{staticClass:"col-1"},[s("avatar",{staticClass:"group-member-avatar",attrs:{src:e.avatar},nativeOn:{click:function(t){return e.showGroupMemberProfile(t)}}})],1):e._e(),s("div",{staticClass:"col-2"},[e.showMessageHeader?s("message-header",{attrs:{message:e.message}}):e._e(),s("div",{staticClass:"content-wrapper"},[e.isMine?s("message-status-icon",{attrs:{message:e.message}}):e._e(),e.message.type===e.TIM.TYPES.MSG_TEXT?s("text-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_IMAGE?s("image-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_FILE?s("file-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_SOUND?s("sound-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_GRP_TIP?s("group-tip-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_CUSTOM?s("custom-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_FACE?s("face-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_VIDEO?s("video-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_GEO?s("geo-element",{attrs:{isMine:e.isMine,payload:e.message.payload,message:e.message}}):s("span",[e._v("æš‚æœªæ”¯æŒçš„æ¶ˆæ¯ç±»å‹ï¼š"+e._s(e.message.type))])],1)],1),s("div",{staticClass:"col-3"})]):e._e(),e.currentConversationType===e.TIM.TYPES.CONV_SYSTEM?s("div",{staticClass:"system-layout"},[s("div",{staticClass:"col-1"},[s("avatar",{attrs:{src:e.avatar,type:e.currentConversationType}})],1),s("div",{staticClass:"col-2"},[s("message-header",{attrs:{message:e.message}}),s("group-system-notice-element",{attrs:{payload:e.message.payload,message:e.message}})],1)]):e._e()])},B=[],Y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:e.messageIconClass,staticStyle:{width:"16px",height:"16px"},on:{click:e.handleIconClick}},[e._v(e._s("message-send-fail"===e.messageIconClass?"!":""))])},F=[],V={name:"MessageStatusIcon",props:{message:{type:Object,required:!0}},computed:{messageIconClass(){switch(this.message.status){case"unSend":return"el-icon-loading";case"fail":return"message-send-fail";default:return""}}},methods:{handleIconClick(){"message-send-fail"===this.messageIconClass&&this.tim.resendMessage(this.message).catch(e=>{this.$store.commit("showMessage",{message:e.message,type:"error"})})}}},q=V,H=(s("a86b"),Object(d["a"])(q,Y,F,!1,null,"97210bde",null)),K=H.exports,z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"base",class:[e.isMine?"right":"left"]},[s("div",{staticClass:"name text-ellipsis"},[e._v(e._s(e.from))]),s("div",{staticClass:"date"},[e._v(e._s(e.date))])])},J=[];function Q(e,t="-"){const s=e.getFullYear(),r=e.getMonth()+1,i=e.getDate();return`${s}${t}${ee(r)}${t}${ee(i)}`}function W(e,t=!1){const s=e.getHours(),r=e.getMinutes(),i=e.getSeconds();return t?`${ee(s)}:${ee(r)}:${ee(i)}`:`${s}:${ee(r)}`}function Z(e){return`${Q(e)} ${W(e)}`}function X(e){return e.toDateString()===(new Date).toDateString()}function ee(e){return e<10?"0"+e:e}function te(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function se(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?te(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):te(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var re={name:"MessageHeader",props:{message:{type:Object,required:!0}},computed:se(se({},Object(y["mapState"])({currentConversation:e=>e.conversation.currentConversation,currentUserProfile:e=>e.user.currentUserProfile,currentMemberList:e=>e.group.currentMemberList})),{},{date(){return Z(new Date(1e3*this.message.time))},from(){const e=this.currentConversation.type===this.TIM.TYPES.CONV_C2C;if(this.isMine){const t=e?void 0:this.currentConversation.groupProfile.selfInfo.nameCard;return t||this.currentUserProfile.nick||this.currentUserProfile.userID}return e?this.currentConversation.userProfile.nick||this.currentConversation.userProfile.userID:this.currentConversation.type===this.TIM.TYPES.CONV_SYSTEM?this.message.type===this.TIM.TYPES.MSG_GRP_SYS_NOTICE?"ç¾¤ç³»ç»Ÿé€šçŸ¥":"ç³»ç»Ÿé€šçŸ¥":this.message.nameCard||this.message.nick||this.message.from},isMine(){return"out"===this.message.flow}})},ie=re,oe=(s("9122"),Object(d["a"])(ie,z,J,!1,null,"39b88506",null)),ne=oe.exports,ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"base",class:[e.isMine?"right":"left"]},[s("div",{staticClass:"date"},[e._v(e._s(e.date))])])},ce=[];function le(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function ue(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?le(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):le(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var pe={name:"MessageFooter",props:{message:{type:Object,required:!0}},computed:ue(ue({},Object(y["mapState"])({currentConversation:e=>e.conversation.currentConversation,currentUserProfile:e=>e.user.currentUserProfile,currentMemberList:e=>e.group.currentMemberList})),{},{date(){return Z(new Date(1e3*this.message.time))},from(){const e=this.currentConversation.type===this.TIM.TYPES.CONV_C2C;return this.isMine?this.currentUserProfile.nick||this.currentUserProfile.userID:e?this.currentConversation.userProfile.nick||this.currentConversation.userProfile.userID:this.message.nick||this.message.from},isMine(){return"out"===this.message.flow}})},me=pe,de=(s("e017"),Object(d["a"])(me,ae,ce,!1,null,"11baf300",null)),he=de.exports,ge=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("message-bubble",{attrs:{isMine:e.isMine,message:e.message}},[s("div",{staticClass:"file-element-wrapper",attrs:{title:"å•å‡»ä¸‹è½½"},on:{click:e.downloadFile}},[s("div",{staticClass:"header"},[s("i",{staticClass:"el-icon-document file-icon"}),s("div",{staticClass:"file-element"},[s("span",{staticClass:"file-name"},[e._v(e._s(e.fileName))]),s("span",{staticClass:"file-size"},[e._v(e._s(e.size))])])]),e.showProgressBar?s("el-progress",{attrs:{percentage:e.percentage,color:function(e){return 100===e?"#67c23a":"#409eff"}}}):e._e()],1)])},fe=[],be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat-bubble",on:{mousedown:function(e){e.stopPropagation()},contextmenu:function(e){e.preventDefault()}}},[e.message.isRevoked?e._e():s("el-dropdown",{ref:"dropdown",attrs:{trigger:""},on:{command:e.handleCommand}},[s("div",{staticStyle:{display:"flex"}},[e.isMine&&e.messageReadByPeer?s("div",{staticClass:"message-status"},[s("span",[e._v(e._s(e.messageReadByPeer))])]):e._e(),s("div",{staticClass:"message-content",class:e.bubbleStyle},[e._t("default")],2)]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.isMine?s("el-dropdown-item",{attrs:{command:"revoke"}},[e._v("æ’¤å›")]):e._e()],1)],1),e.message.isRevoked?s("div",{staticClass:"group-tip-element-wrapper"},[e._v("\n    "+e._s(e.text)+"\n    "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"isEdit"}],staticClass:"edit-button",attrs:{type:"text",size:"mini"},on:{click:e.reEdit}},[e._v("Â é‡æ–°ç¼–è¾‘")])],1):e._e()],1)},ve=[],ye={name:"MessageBubble",data(){return{isTimeout:!1}},props:{isMine:{type:Boolean},isNew:{type:Boolean},message:{type:Object,required:!0}},created(){this.isTimeoutHandler()},mounted(){this.$refs.dropdown&&this.$refs.dropdown.$el&&this.$refs.dropdown.$el.addEventListener("mousedown",this.handleDropDownMousedown)},beforeDestroy(){this.$refs.dropdown&&this.$refs.dropdown.$el&&this.$refs.dropdown.$el.removeEventListener("mousedown",this.handleDropDownMousedown)},computed:{bubbleStyle(){let e="";return this.isMine?e+="message-send":e+="message-received",this.isNew&&(e+="new"),e},text(){return this.message.conversationType!==this.TIM.TYPES.CONV_C2C||this.isMine?this.message.conversationType!==this.TIM.TYPES.CONV_GROUP||this.isMine?"ä½ æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯":this.message.from+"æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯":"å¯¹æ–¹æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯"},messageReadByPeer(){return"success"===this.message.status&&(this.message.conversationType===this.TIM.TYPES.CONV_C2C&&this.message.isPeerRead?"å·²è¯»":this.message.conversationType!==this.TIM.TYPES.CONV_C2C||this.message.isPeerRead?"":"æœªè¯»")},isEdit(){return!!this.isMine&&(this.message.type===this.TIM.TYPES.MSG_TEXT&&!this.isTimeout)}},methods:{handleDropDownMousedown(e){this.isMine&&!this.isTimeout&&2===e.buttons&&(this.$refs.dropdown.visible?this.$refs.dropdown.hide():this.$refs.dropdown.show())},handleCommand(e){switch(e){case"revoke":this.tim.revokeMessage(this.message).then(()=>{this.isTimeoutHandler()}).catch(e=>{this.$store.commit("showMessage",{message:e,type:"warning"})});break;case"delete":break;default:break}},isTimeoutHandler(){let e=new Date;parseInt(e.getTime()/1e3)-this.message.time>120?this.isTimeout=!0:setTimeout(this.isTimeoutHandler,1e3)},reEdit(){this.$bus.$emit("reEditMessage",this.message.payload.text)}}},Oe=ye,Ce=(s("c8ad"),Object(d["a"])(Oe,be,ve,!1,null,"5d538831",null)),we=Ce.exports,Pe={name:"FileElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0},isMine:{type:Boolean}},components:{MessageBubble:we,ElProgress:o["Progress"]},computed:{fileName(){return this.payload.fileName},fileUrl(){return this.payload.fileUrl},size(){const e=this.payload.fileSize;return e>1024?e/1024>1024?this.toFixed(e/1024/1024)+" Mb":this.toFixed(e/1024)+" Kb":this.toFixed(e)+"B"},showProgressBar(){return"unSend"===this.$parent.message.status},percentage(){return Math.floor(100*(this.$parent.message.progress||0))}},methods:{toFixed(e,t=2){return e.toFixed(t)},downloadFile(){if(window.fetch)fetch(this.fileUrl).then(e=>e.blob()).then(e=>{let t=document.createElement("a"),s=window.URL.createObjectURL(e);t.href=s,t.download=this.fileName,t.click()});else{let e=document.createElement("a");e.href=this.fileUrl,e.target="_blank",e.download=this.filename,e.click()}}}},_e=Pe,Me=(s("4d06"),Object(d["a"])(_e,ge,fe,!1,null,"96091f5a",null)),Ie=Me.exports,je=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("message-bubble",{attrs:{isMine:e.isMine,message:e.message}},[s("div",{staticClass:"face-element-wrapper"},[s("img",{attrs:{src:e.url}})])])},Te=[],Ee={name:"FaceElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0},isMine:{type:Boolean}},components:{MessageBubble:we},computed:{url(){let e="";return e=this.payload.data.indexOf("@2x")>0?this.payload.data:this.payload.data+"@2x",`https://webim-1252463788.file.myqcloud.com/assets/face-elem/${e}.png`}}},Se=Ee,De=(s("24c8"),Object(d["a"])(Se,je,Te,!1,null,"848acce2",null)),xe=De.exports,ke=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("message-bubble",{attrs:{isMine:e.isMine,message:e.message}},[s("img",{staticClass:"image-element",attrs:{src:e.imageUrl},on:{load:e.onImageLoaded,click:e.handlePreview}}),e.showProgressBar?s("el-progress",{attrs:{percentage:e.percentage,color:function(e){return 100===e?"#67c23a":"#409eff"}}}):e._e()],1)},Ae=[];function Ge(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function $e(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ge(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Le={name:"ImageElemnt",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0},isMine:{type:Boolean}},components:{MessageBubble:we,ElProgress:o["Progress"]},computed:$e($e({},Object(y["mapGetters"])(["imgUrlList"])),{},{imageUrl(){const e=this.payload.imageInfoArray[0].url;return"string"!==typeof e?"":"//"===e.slice(0,2)?"https:"+e:e},showProgressBar(){return"unSend"===this.$parent.message.status},percentage(){return Math.floor(100*(this.$parent.message.progress||0))}}),methods:{onImageLoaded(e){this.$bus.$emit("image-loaded",e)},handlePreview(){this.$bus.$emit("image-preview",{url:this.payload.imageInfoArray[0].url})}}},Re=Le,Ne=(s("8810"),Object(d["a"])(Re,ke,Ae,!1,null,"306e62ad",null)),Ue=Ne.exports,Be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("message-bubble",{attrs:{isMine:e.isMine,message:e.message}},[e._l(e.contentList,(function(t,r){return["text"===t.name?s("span",{key:r,domProps:{innerHTML:e._s(e.postProcess(t.text))}}):"img"===t.name?s("img",{key:r,attrs:{src:t.src,width:"20px",height:"20px"}}):e._e()]}))],2)},Ye=[];s("3b2b");function Fe(e){let t=[],s=e.text,r=-1,i=-1;while(""!==s)switch(r=s.indexOf("["),i=s.indexOf("]"),r){case 0:if(-1===i)t.push({name:"text",text:s}),s="";else{let e=s.slice(0,i+1);I[e]?(t.push({name:"img",src:M+I[e]}),s=s.substring(i+1)):(t.push({name:"text",text:"["}),s=s.slice(1))}break;case-1:t.push({name:"text",text:s}),s="";break;default:t.push({name:"text",text:s.slice(0,r)}),s=s.substring(r);break}return t}function Ve(e){const t=document.createElement("div");return t.innerText=e,t.innerHTML}const qe="\n  åŠ›é‡ ä½“è´¨ ä½“å‹ æ•æ· å¤–è²Œ æ™ºåŠ› çµæ„Ÿ æ„å¿— æ•™è‚² ç†æ™º å¹¸è¿ \n".trim().split(/\s+/),He="\n  ä¼šè®¡ äººç±»å­¦ ä¼°ä»· è€ƒå¤å­¦ é­…æƒ‘ æ”€çˆ¬ è®¡ç®—æœº ä¿¡ç”¨ å…‹è‹é²ç¥è¯ ä¹”è£… é—ªé¿ é©¾é©¶ ç”µæ°”ç»´ä¿® ç”µå­å­¦ è¯æœ¯ æ ¼æ–— å°„å‡»\n  æ€¥æ•‘ å†å² æå“ è·³è·ƒ æ¯è¯­ æ³•å¾‹ å›¾ä¹¦é¦† è†å¬ é”åŒ  æœºæ¢°ç»´ä¿® åŒ»å­¦ åšç‰©å­¦ é¢†èˆª ç¥ç§˜å­¦ é‡å‹æœºæ¢° è¯´æœ ç²¾ç¥åˆ†æ\n  å¿ƒç†å­¦ éª‘æœ¯ å¦™æ‰‹ ä¾¦æŸ¥ ä¾¦å¯Ÿ æ½œè¡Œ æ¸¸æ³³ æŠ•æ· è¿½è¸ª sc SC\n".trim().split(/\s+/),Ke={basic:{},props:{},skills:{}};function ze(e){const t=JSON.parse(JSON.stringify(Ke));t.basic={name:e["D3"].v,job:e["D5"].v,age:e["D6"].v,gender:e["L6"].v,hp:e["F10"].v,san:e["N10"].v,luck:e["V10"].v,mp:(e["AD10"]||e["AF10"]).v},t.props={"åŠ›é‡":e["S3"].v,"ä½“è´¨":e["S5"].v,"ä½“å‹":e["S7"].v,"æ•æ·":e["Y3"].v,"å¤–è²Œ":e["Y5"].v,"æ™ºåŠ›":e["Y7"].v,"æ„å¿—":e["AE3"].v,"æ•™è‚²":e["AE5"].v};const s=[19,20,21,33,34,35,36,37,38,43,44,45];for(let i=15;i<=46;i++){let r=e[(s.includes(i)?"E":"C")+i];r&&(t.skills[Je(r.v)]=e["P"+i].v)}const r=[26,30,31,32,36,40];for(let i=15;i<=40;i++){let s=e[(r.includes(i)?"Y":"W")+i];s&&(t.skills[Je(s.v)]=e["AJ"+i].v)}return t}function Je(e){switch(e){case"è®¡ç®—æœºä½¿ç”¨ Î©":return"è®¡ç®—æœº";case"å›¾ä¹¦é¦†ä½¿ç”¨":return"å›¾ä¹¦é¦†";case"ç”µå­å­¦ Î©":return"ç”µå­å­¦";case"æ¯è¯­:":return"æ¯è¯­";default:return e}}const Qe=new RegExp(`(${qe.concat(He).join("|")})`,"g");var We={name:"TextElement",components:{MessageBubble:we},props:{payload:{type:Object,required:!0},message:{type:Object,required:!0},isMine:{type:Boolean}},computed:{contentList(){return Fe(this.payload)}},methods:{postProcess(e){if(this.message.conversationType===this.TIM.TYPES.CONV_GROUP){const t=this.$store.state.group.currentMemberList.filter(e=>e.userID===this.message.from);if(t.length>0&&t[0].role===this.TIM.TYPES.GRP_MBR_ROLE_OWNER){let t=e.match(/(å›°éš¾|æéš¾|æé™)/);return t=t?t[0]:"",this.escape(e).replace(Qe,`<span class="underline" onclick="_onclickspan('${t}$1')">$1</span>`)}}return this.escape(e)},escape(e){return Ve(e)}}};window._onclickspan=e=>{let t=document.getElementById("ghost-message-send-box");t.innerText=".d% "+e,t.click()};var Ze=We,Xe=(s("8e6d"),s("413d"),Object(d["a"])(Ze,Be,Ye,!1,null,"6f20670e",null)),et=Xe.exports,tt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("message-bubble",{attrs:{isMine:e.isMine,message:e.message}},[s("div",{staticClass:"sound-element-wrapper",attrs:{title:"å•å‡»æ’­æ”¾"},on:{click:e.play}},[s("i",{staticClass:"iconfont icon-voice"}),e._v("\n    "+e._s(e.second+'"')+"\n  ")])])},st=[],rt={name:"SoundElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0},isMine:{type:Boolean}},components:{MessageBubble:we},data(){return{amr:null}},computed:{url(){return this.payload.url},size(){return this.payload.size},second(){return this.payload.second}},methods:{play(){const e=document.createElement("audio");e.addEventListener("error",this.tryPlayAMR),e.src=this.url;const t=e.play();t&&t.catch(()=>{})},tryPlayAMR(){try{const e=/MSIE|Trident|Edge/.test(window.navigator.userAgent);if(e)return void this.$store.commit("showMessage",{message:"æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯¥æ ¼å¼çš„è¯­éŸ³æ¶ˆæ¯æ’­æ”¾ï¼Œè¯·å°è¯•æ›´æ¢æµè§ˆå™¨ï¼Œå»ºè®®ä½¿ç”¨ï¼šè°·æ­Œæµè§ˆå™¨",type:"warning"});if(!window.BenzAMRRecorder){const e=document.createElement("script");e.addEventListener("load",this.playAMR),e.src="./BenzAMRRecorder.js";const t=document.getElementsByTagName("script")[0];return void t.parentNode.insertBefore(e,t)}this.playAMR()}catch(e){this.$store.commit("showMessage",{message:"æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯¥æ ¼å¼çš„è¯­éŸ³æ¶ˆæ¯æ’­æ”¾ï¼Œè¯·å°è¯•æ›´æ¢æµè§ˆå™¨ï¼Œå»ºè®®ä½¿ç”¨ï¼šè°·æ­Œæµè§ˆå™¨",type:"warning"})}},playAMR(){!this.amr&&window.BenzAMRRecorder&&(this.amr=new window.BenzAMRRecorder),this.amr.isInit()?this.amr.play():this.amr.initWithUrl(this.url).then(()=>{this.amr.play()})}}},it=rt,ot=(s("777c"),Object(d["a"])(it,tt,st,!1,null,"7ab0530b",null)),nt=ot.exports,at=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("message-bubble",{attrs:{isMine:e.isMine,message:e.message}},[s("video",{staticClass:"video",attrs:{src:e.payload.videoUrl,controls:""},on:{error:e.videoError}}),e.showProgressBar?s("el-progress",{attrs:{percentage:e.percentage,color:function(e){return 100===e?"#67c23a":"#409eff"}}}):e._e()],1)},ct=[],lt={name:"VideoElement",components:{MessageBubble:we,ElProgress:o["Progress"]},props:{payload:{type:Object,required:!0},message:{type:Object,required:!0},isMine:{type:Boolean}},computed:{showProgressBar(){return"unSend"===this.message.status},percentage(){return Math.floor(100*(this.$parent.message.progress||0))}},methods:{videoError(e){this.$store.commit("showMessage",{type:"error",message:"è§†é¢‘å‡ºé”™ï¼Œé”™è¯¯åŸå› ï¼š"+e.target.error.message})}}},ut=lt,pt=(s("e3ec"),Object(d["a"])(ut,at,ct,!1,null,"6237ab78",null)),mt=pt.exports,dt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"group-tip-element-wrapper"},[e._v(e._s(e.text))])},ht=[];function gt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function ft(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):gt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var bt={name:"GroupTipElement",data(){return{callTips:256}},props:{payload:{type:Object,required:!0},message:{type:Object,required:!1}},computed:ft(ft({},Object(y["mapState"])({currentUserProfile:e=>e.user.currentUserProfile,userID:e=>e.user.userID})),{},{text(){return this.getGroupTipContent(this.message)}}),methods:{getGroupTipContent(e){let t=e.nick||e.from===this.userID&&this.currentUserProfile.nick||e.from;const s=e.nick||e.payload.userIDList.join(",");switch(e.payload.operationType){case this.TIM.TYPES.GRP_TIP_MBR_JOIN:return`ç¾¤æˆå‘˜ï¼š${s} åŠ å…¥ç¾¤ç»„`;case this.TIM.TYPES.GRP_TIP_MBR_QUIT:return`ç¾¤æˆå‘˜ï¼š${s} é€€å‡ºç¾¤ç»„`;case this.TIM.TYPES.GRP_TIP_MBR_KICKED_OUT:return`ç¾¤æˆå‘˜ï¼š${s} è¢«${e.payload.operatorID}è¸¢å‡ºç¾¤ç»„`;case this.TIM.TYPES.GRP_TIP_MBR_SET_ADMIN:return`ç¾¤æˆå‘˜ï¼š${s} æˆä¸ºç®¡ç†å‘˜`;case this.TIM.TYPES.GRP_TIP_MBR_CANCELED_ADMIN:return`ç¾¤æˆå‘˜ï¼š${s} è¢«æ’¤é”€ç®¡ç†å‘˜`;case this.TIM.TYPES.GRP_TIP_GRP_PROFILE_UPDATED:return"ç¾¤èµ„æ–™ä¿®æ”¹";case this.callTips:return e.payload.text.indexOf("ç»“æŸç¾¤èŠ")>-1?`"${e.payload.text}"`:`"${t}" ${e.payload.text}`;case this.TIM.TYPES.GRP_TIP_MBR_PROFILE_UPDATED:for(let t of e.payload.memberList)return t.muteTime>0?`ç¾¤æˆå‘˜ï¼š${t.userID}è¢«ç¦è¨€${t.muteTime}ç§’`:`ç¾¤æˆå‘˜ï¼š${t.userID}è¢«å–æ¶ˆç¦è¨€`;break;default:return"[ç¾¤æç¤ºæ¶ˆæ¯]"}}}},vt=bt,yt=(s("3763"),Object(d["a"])(vt,dt,ht,!1,null,"7862d93a",null)),Ot=yt.exports,Ct=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("message-bubble",{attrs:{isMine:!1,message:e.message}},[s("div",{staticClass:"group-system-element-wrapper"},[e._v("\n    "+e._s(e.text)+"\n    "),e.isJoinGroupRequest?s("el-button",{attrs:{type:"text"},on:{click:function(t){e.showDialog=!0}}},[e._v("å¤„ç†")]):e._e(),s("el-dialog",{attrs:{title:"å¤„ç†åŠ ç¾¤ç”³è¯·",visible:e.showDialog,width:"30%"},on:{"update:visible":function(t){e.showDialog=t}}},[s("el-form",{ref:"form",attrs:{"label-width":"100px"},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[s("el-form-item",{attrs:{label:"å¤„ç†ç»“æœï¼š"}},[s("el-radio-group",{model:{value:e.form.handleAction,callback:function(t){e.$set(e.form,"handleAction",t)},expression:"form.handleAction"}},[s("el-radio",{attrs:{label:"Agree"}},[e._v("åŒæ„")]),s("el-radio",{attrs:{label:"Reject"}},[e._v("æ‹’ç»")])],1)],1),s("el-form-item",{attrs:{label:"é™„è¨€ï¼š"}},[s("el-input",{attrs:{type:"textarea",resize:"none",rows:3,placeholder:"è¯·è¾“å…¥é™„è¨€"},model:{value:e.form.handleMessage,callback:function(t){e.$set(e.form,"handleMessage",t)},expression:"form.handleMessage"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("å– æ¶ˆ")]),s("el-button",{attrs:{type:"primary"},on:{click:e.handleGroupApplication}},[e._v("ç¡® å®š")])],1)],1)],1)])},wt=[];function Pt(e){const t=e.payload.groupProfile.name||e.payload.groupProfile.groupID;switch(e.payload.operationType){case 1:return`${e.payload.operatorID} ç”³è¯·åŠ å…¥ç¾¤ç»„ï¼š${t}`;case 2:return"æˆåŠŸåŠ å…¥ç¾¤ç»„ï¼š"+t;case 3:return`ç”³è¯·åŠ å…¥ç¾¤ç»„ï¼š${t}è¢«æ‹’ç»`;case 4:return`ä½ è¢«ç®¡ç†å‘˜${e.payload.operatorID}è¸¢å‡ºç¾¤ç»„ï¼š${t}`;case 5:return`ç¾¤ï¼š${t} å·²è¢«${e.payload.operatorID}è§£æ•£`;case 6:return`${e.payload.operatorID}åˆ›å»ºç¾¤ï¼š${t}`;case 7:return`${e.payload.operatorID}é‚€è¯·ä½ åŠ ç¾¤ï¼š${t}`;case 8:return"ä½ é€€å‡ºç¾¤ç»„ï¼š"+t;case 9:return`ä½ è¢«${e.payload.operatorID}è®¾ç½®ä¸ºç¾¤ï¼š${t}çš„ç®¡ç†å‘˜`;case 10:return`ä½ è¢«${e.payload.operatorID}æ’¤é”€ç¾¤ï¼š${t}çš„ç®¡ç†å‘˜èº«ä»½`;case 255:return"è‡ªå®šä¹‰ç¾¤ç³»ç»Ÿé€šçŸ¥: "+e.payload.userDefinedField}}var _t={name:"GroupSystemNoticeElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!1}},components:{ElDialog:o["Dialog"],ElForm:o["Form"],ElFormItem:o["FormItem"],ElRadioGroup:o["RadioGroup"],ElRadio:o["Radio"],MessageBubble:we},data(){return{showDialog:!1,form:{handleAction:"Agree",handleMessage:""}}},computed:{text(){return Pt(this.message)},title(){return this.message.type===this.TIM.TYPES.MSG_GRP_SYS_NOTICE?"ç¾¤ç³»ç»Ÿé€šçŸ¥":"ç³»ç»Ÿé€šçŸ¥"},isJoinGroupRequest(){return 1===this.payload.operationType}},methods:{handleGroupApplication(){this.tim.handleGroupApplication({handleAction:this.form.handleAction,handleMessage:this.form.handleMessage,message:this.message}).then(()=>{this.showDialog=!1,this.$store.commit("removeMessage",this.message)}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message}),this.showDialog=!1})}}},Mt=_t,It=(s("4011"),Object(d["a"])(Mt,Ct,wt,!1,null,"8a49ee1a",null)),jt=It.exports,Tt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"group-tip-element-wrapper"},[e._v(e._s(e.text))])},Et=[];function St(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function Dt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?St(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):St(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var xt={name:"CustomElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0},isMine:{type:Boolean}},components:{MessageBubble:we},computed:Dt(Dt({},Object(y["mapState"])({currentUserProfile:e=>e.user.currentUserProfile})),{},{text(){return this.translateCustomMessage(this.payload)}}),methods:{translateCustomMessage(e){return e.description}}},kt=xt,At=(s("ec25"),Object(d["a"])(kt,Tt,Et,!1,null,"3a2bf9c9",null)),Gt=At.exports,$t=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("message-bubble",{attrs:{isMine:e.isMine,message:e.message}},[s("a",{staticClass:"geo-element",attrs:{href:e.href,target:"_blank",title:"ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…"}},[s("span",{staticClass:"el-icon-location-outline"},[e._v(e._s(e.payload.description))]),s("img",{attrs:{src:e.url}})])])},Lt=[],Rt={name:"GeoElement",components:{MessageBubble:we},props:{payload:{type:Object,required:!0},message:{type:Object,required:!0},isMine:{type:Boolean}},data(){return{url:""}},computed:{lon(){return this.payload.longitude.toFixed(6)},lat(){return this.payload.latitude.toFixed(6)},href(){return`https://map.qq.com/?type=marker&isopeninfowin=1&markertype=1&pointx=${this.lon}&pointy=${this.lat}&name=${this.payload.description}`}},mounted(){this.url=`https://apis.map.qq.com/ws/staticmap/v2/?center=${this.lat},${this.lon}&zoom=10&size=300*150&maptype=roadmap&markers=size:large|color:0xFFCCFF|label:k|${this.lat},${this.lon}&key=UBNBZ-PTP3P-TE7DB-LHRTI-Y4YLE-VWBBD`}},Nt=Rt,Ut=(s("daca"),Object(d["a"])(Nt,$t,Lt,!1,null,"58085edc",null)),Bt=Ut.exports;function Yt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function Ft(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Yt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Vt={name:"MessageItem",props:{message:{type:Object,required:!0}},components:{MessageHeader:ne,MessageFooter:he,MessageStatusIcon:K,FileElement:Ie,FaceElement:xe,ImageElement:Ue,TextElement:et,SoundElement:nt,GroupTipElement:Ot,GroupSystemNoticeElement:jt,CustomElement:Gt,VideoElement:mt,GeoElement:Bt},data(){return{renderDom:[]}},computed:Ft(Ft({},Object(y["mapState"])({currentConversation:e=>e.conversation.currentConversation,currentUserProfile:e=>e.user.currentUserProfile})),{},{showAvatar(){return"C2C"===this.currentConversation.type&&!this.message.isRevoked||"GROUP"===this.currentConversation.type&&!this.message.isRevoked&&(this.message.type!==this.TIM.TYPES.MSG_GRP_TIP&&this.message.type!==this.TIM.TYPES.MSG_CUSTOM)},avatar(){return"C2C"===this.currentConversation.type?this.isMine?this.currentUserProfile.avatar:this.currentConversation.userProfile.avatar:"GROUP"===this.currentConversation.type?this.isMine?this.currentUserProfile.avatar:this.message.avatar:""},currentConversationType(){return this.currentConversation.type},isMine(){return"out"===this.message.flow},messagePosition(){return["TIMGroupTipElem","TIMGroupSystemNoticeElem",this.TIM.TYPES.MSG_CUSTOM].includes(this.message.type)||this.message.isRevoked?"position-center":this.isMine?"position-right":"position-left"},showMessageHeader(){return!["TIMGroupTipElem","TIMGroupSystemNoticeElem",this.TIM.TYPES.MSG_CUSTOM].includes(this.message.type)&&!this.message.isRevoked}}),methods:{showGroupMemberProfile(e){this.tim.getGroupMemberProfile({groupID:this.message.to,userIDList:[this.message.from]}).then(({data:{memberList:t}})=>{t[0]&&this.$bus.$emit("showMemberProfile",{event:e,member:t[0]})})}}},qt=Vt,Ht=(s("8674"),Object(d["a"])(qt,U,B,!1,null,"14ff1cbc",null)),Kt=Ht.exports,zt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"conversation-profile-wrapper"},[e.currentConversation.type===e.TIM.TYPES.CONV_C2C?s("user-profile",{attrs:{userProfile:e.currentConversation.userProfile}}):e.currentConversation.type===e.TIM.TYPES.CONV_GROUP?s("group-profile",{attrs:{groupProfile:e.currentConversation.groupProfile}}):e._e()],1)},Jt=[],Qt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("group-member-list",{attrs:{groupProfile:e.groupProfile}}),s("div",{staticClass:"group-info-content"},[s("div",{staticClass:"info-item"},[s("div",{staticClass:"label"},[e._v("\n          ç¾¤å¤´åƒ\n          "),e.editable?s("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer","font-size":"14px"},on:{click:function(t){e.showEditFaceUrl=!0,e.inputFocus("editFaceUrl")}}}):e._e()]),e.showEditFaceUrl?s("el-input",{ref:"editFaceUrl",staticStyle:{width:"60%"},attrs:{autofocus:"",size:"mini"},on:{blur:function(t){e.showEditFaceUrl=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editFaceUrl(t)}},model:{value:e.avatar,callback:function(t){e.avatar=t},expression:"avatar"}}):s("div",{staticClass:"content"},[s("avatar",{attrs:{src:e.groupProfile.avatar}})],1)],1),s("div",{staticClass:"info-item"},[s("div",{staticClass:"label"},[e._v("\n          ç¾¤åç§°\n          "),e.editable?s("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer","font-size":"14px"},on:{click:function(t){e.showEditName=!0,e.inputFocus("editName")}}}):e._e()]),e.showEditName?s("el-input",{ref:"editName",staticStyle:{width:"60%"},attrs:{autofocus:"",size:"mini"},on:{blur:function(t){e.showEditName=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editName(t)}},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}):s("div",{staticClass:"content text-ellipsis",attrs:{title:e.groupProfile.name}},[e._v("\n          "+e._s(e.groupProfile.name||"æš‚æ— ")+"\n        ")])],1),s("div",{staticClass:"info-item"},[s("div",{staticClass:"label"},[e._v("\n          ç¾¤æ¶ˆæ¯æç¤ºç±»å‹\n          "),e.editable?s("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer","font-size":"14px"},on:{click:function(t){e.showEditMessageRemindType=!0,e.inputFocus("editMessageRemindType")}}}):e._e()]),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.showEditMessageRemindType,expression:"!showEditMessageRemindType"}],staticClass:"content"},[e._v("\n          "+e._s(e.messageRemindTypeMap[this.groupProfile.selfInfo.messageRemindType])+"\n        ")]),s("el-select",{directives:[{name:"show",rawName:"v-show",value:e.showEditMessageRemindType,expression:"showEditMessageRemindType"}],ref:"editMessageRemindType",attrs:{size:"mini","automatic-dropdown":""},on:{change:e.editMessageRemindType,blur:function(t){e.showEditMessageRemindType=!1}},model:{value:e.messageRemindType,callback:function(t){e.messageRemindType=t},expression:"messageRemindType"}},[s("el-option",{attrs:{label:"æ¥æ”¶æ¶ˆæ¯å¹¶æç¤º",value:"AcceptAndNotify"}}),s("el-option",{attrs:{label:"æ¥æ”¶æ¶ˆæ¯ä½†ä¸æç¤º",value:"AcceptNotNotify"}}),s("el-option",{attrs:{label:"å±è”½æ¶ˆæ¯",value:"Discard"}})],1)],1),s("div",{staticClass:"info-item"},[s("div",{staticClass:"label"},[e._v("\n          æˆ‘çš„ç¾¤åç‰‡\n          "),s("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer","font-size":"14px"},on:{click:function(t){e.showEditNameCard=!0,e.inputFocus("editNameCard")}}})]),e.showEditNameCard?s("el-input",{ref:"editNameCard",staticStyle:{width:"60%"},attrs:{autofocus:"",size:"mini"},on:{blur:function(t){e.showEditNameCard=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editNameCard(t)}},model:{value:e.nameCard,callback:function(t){e.nameCard=t},expression:"nameCard"}}):s("div",{staticClass:"content cursor-pointer"},[e._v("\n          "+e._s(e.groupProfile.selfInfo.nameCard||"æš‚æ— ")+"\n        ")])],1),e.isOwner?s("div",{staticClass:"info-item"},[s("div",{staticClass:"label"},[e._v("å…¨ä½“ç¦è¨€")]),s("el-switch",{on:{change:e.changeMuteStatus},model:{value:e.muteAllMembers,callback:function(t){e.muteAllMembers=t},expression:"muteAllMembers"}})],1):e._e(),e.isOwner?s("div",{staticClass:"info-item"},[s("div",{staticClass:"label"},[e._v("å¯ç”¨æœºå™¨äºº")]),s("bot-switch")],1):e._e(),s("div",{staticClass:"info-item"},[s("div",{staticClass:"label"},[e._v("\n          ç¾¤å…¬å‘Š\n          "),e.editable?s("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer","font-size":"14px"},on:{click:function(t){e.showEditNotification=!0,e.inputFocus("editNotification")}}}):e._e()]),e.showEditNotification?s("el-input",{ref:"editNotification",staticStyle:{width:"60%"},attrs:{autofocus:"",size:"mini"},on:{blur:function(t){e.showEditNotification=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editNotification(t)}},model:{value:e.notification,callback:function(t){e.notification=t},expression:"notification"}}):s("div",{staticClass:"long-content",attrs:{title:e.groupProfile.notification}},[e._v("\n          "+e._s(e.groupProfile.notification||"æš‚æ— ")+"\n        ")])],1)]),s("div",{staticClass:"action-btns"},[e.isOwner?s("kp-actions"):e._e(),s("div",[s("div",[s("el-button",{attrs:{type:"text"},on:{click:e.quitGroup}},[e._v("é€€å‡ºç¾¤ç»„")])],1),e.showDissmissGroup?s("div",[s("el-button",{attrs:{type:"text"},on:{click:e.dismissGroup}},[e._v("è§£æ•£ç¾¤ç»„")])],1):e._e()])],1)],1)},Wt=[],Zt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"group-member-list-wrapper"},[s("div",{staticClass:"header"},[s("span",{staticClass:"member-count text-ellipsis"},[e._v("ç¾¤æˆå‘˜ï¼š"+e._s(e.members.length))]),s("i",{staticClass:"el-icon-link",attrs:{title:"å¤åˆ¶é‚€è¯·é“¾æ¥"},on:{click:function(t){e.inviteDialogShow=!0}}}),s("i",{staticClass:"el-icon-refresh",attrs:{title:"åˆ·æ–°ç¾¤æˆå‘˜ä¿¡æ¯"},on:{click:e.refreshGroupMember}})]),s("div",{staticClass:"scroll-content"},[s("div",{staticClass:"group-member-list"},e._l(e.members,(function(t){return s("div",{key:t.userID},[s("div",{staticClass:"group-member",attrs:{slot:"reference"},slot:"reference"},[s("div",{staticClass:"info"},[s("avatar",{attrs:{title:e.getGroupMemberAvatarText(t.role),src:t.avatar}}),s("div",{staticClass:"names"},[s("div",{staticClass:"member-name text-ellipsis"},[e._v(e._s(e.getShowUserNick(t)))]),s("div",{staticClass:"member-id"},[e._v(e._s(e.getShowUserId(t)))])])],1),s("div",{staticClass:"actions"},[t.userID.startsWith("bot")?e._e():s("el-button",{staticClass:"action-btn",attrs:{title:"æŸ¥çœ‹äººç‰©å¡",icon:"el-icon-tickets",size:"mini",circle:""},on:{click:function(s){return e.openUserCard(t.userID)}}}),e.isOwner?s("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleDropdownCommand}},[s("el-button",{staticClass:"action-btn",attrs:{title:"æ›´å¤šæ“ä½œ",icon:"el-icon-more",size:"mini",circle:""}}),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.userID.startsWith("bot")?e._e():s("el-dropdown-item",{attrs:{icon:"el-icon-circle-plus-outline",command:"ImportCard:"+t.userID}},[e._v("\n                      å¯¼å…¥äººç‰©å¡\n                    ")]),e.isBotOfThisGroup(t)?s("el-dropdown-item",{attrs:{icon:"el-icon-picture-outline",command:"SetAvatar:"+t.userID}},[e._v("\n                      ä¿®æ”¹å¤´åƒ\n                    ")]):e._e(),s("el-dropdown-item",{attrs:{icon:"el-icon-edit",command:"SetNick:"+t.userID}},[e._v("\n                      ä¿®æ”¹ç¾¤åç‰‡\n                    ")]),"Owner"!==t.role?s("el-dropdown-item",{staticStyle:{color:"#F56C6C"},attrs:{icon:"el-icon-delete",command:"Kick:"+t.userID}},[e._v("\n                      è¸¢å‡ºç¾¤èŠ\n                    ")]):e._e()],1)],1):e._e()],1)])])})),0)]),e.isOwner?s("card-import",{attrs:{visible:!!e.importCardMemberID,"group-id":e.groupProfile.groupID,"member-id":e.importCardMemberID},on:{"update:visible":function(t){e.importCardMemberID=null}}}):e._e(),s("el-dialog",{attrs:{title:"é‚€è¯·å…¥ç¾¤",visible:e.inviteDialogShow,width:"40%"},on:{"update:visible":function(t){e.inviteDialogShow=t}}},[s("div",{staticClass:"invite-dialog"},[s("div",[s("h3",[e._v("åˆ†äº«ç»™ç½‘é¡µ")]),s("el-button",{attrs:{type:"primary"},on:{click:e.copyInviteLink}},[e._v("å¤åˆ¶é‚€è¯·é“¾æ¥")]),s("div",{staticClass:"desc"},[e._v("å¤åˆ¶åå‘ç»™å°ä¼™ä¼´ï¼Œå°ä¼™ä¼´ç‚¹å‡»é“¾æ¥åœ¨æ–°çª—å£ä¸­æ‰“å¼€ï¼Œç™»å½•åå³å¯è‡ªåŠ¨è¿›ç¾¤")])],1),s("div",[s("h3",[e._v("åˆ†äº«ç»™å°ç¨‹åº")]),s("img",{attrs:{src:e.minacode}}),s("img",{attrs:{src:e.getInviteQRCodeUrl()}}),s("div",{staticClass:"desc"},[e._v("â‘ å¾®ä¿¡æ‰«æå·¦è¾¹äºŒç»´ç æ‰“å¼€ã€è·‘å›¢IOã€‘å°ç¨‹åº"),s("br"),e._v("â‘¡åœ¨å°ç¨‹åºç™»å½•é¡µé¢æ‰«æå³è¾¹äºŒç»´ç ï¼Œè‡ªåŠ¨å¡«å……ä¿¡æ¯"),s("br"),e._v("â‘¢è¾“å…¥è‡ªå·±çš„QQåç™»å½•å³å¯è‡ªåŠ¨è¿›ç¾¤")])])])])],1)},Xt=[];const es=window.TIMC;var ts=es();delete window.TIMC,window.genTestUserSig=(e,t,s)=>{const r=604800,i=new window.LibGenerateTestUserSig(t,s,r),o=i.genTestUserSig(e);return{SDKAppID:t,userSig:o}};var ss=s("5d1f");function rs(e,t){if(t.conversationType===ts.TYPES.CONV_GROUP){const r=t.payload.text.trim();if(r.startsWith(".")||r.startsWith("ã€‚"))try{const[s,i]=r.substr(1).split(" "),o=new ss["DiceRoll"](s),n=os(t.to,t.from,s,i,o.total);is(e,t.to,`${t.nameCard||t.nick||t.from} ğŸ² ${i||""} ${o.output} ${n}`)}catch(s){}}}function is(e,t,s){let r=e.createTextMessage({to:t,conversationType:ts.TYPES.CONV_GROUP,payload:{text:s}});e.sendMessage(r)}function os(e,t,s,r,o){if(!r)return"";const n=i.a.prototype.$store.state.game.list[e];if(!n)return"";const a=n.cards["o"+t];if(!a)return"";if("ç†æ™º"===r||"sc"===r||"SC"===r)return o<=a.basic.san?`â‰¤ ${a.basic.san} æˆåŠŸ`:`> ${a.basic.san} å¤±è´¥`;if("å¹¸è¿"===r)return o<=a.basic.luck?`â‰¤ ${a.basic.luck} æˆåŠŸ`:`> ${a.basic.luck} å¤±è´¥`;if("çµæ„Ÿ"===r)return o<=a.props["æ™ºåŠ›"]?`â‰¤ ${a.props["æ™ºåŠ›"]} æˆåŠŸ`:`> ${a.props["æ™ºåŠ›"]} å¤±è´¥`;const c=r.indexOf("å›°éš¾")>=0,l=r.indexOf("æéš¾")>=0||r.indexOf("æé™")>=0;r=r.replace(/(å›°éš¾|æéš¾|æé™)/g,""),"ä¾¦æŸ¥"===r&&(r="ä¾¦å¯Ÿ");let u=a.props[r]||a.skills[r];return u?1===o?"å¤§æˆåŠŸ":o>95?"å¤§å¤±è´¥":(u=l?Math.floor(u/5):c?Math.floor(u/2):u,o<=u?`â‰¤ ${u} æˆåŠŸ`:`> ${u} å¤±è´¥`):""}var ns=s("3581"),as=s.n(ns);let cs=null,ls=null,us=null,ps=new Proxy({},{get(e,t){if(cs)return cs[t];console.warn("use tim before init!!!")}});var ms=ps;function ds(e,t){cs||(ls=e,us=t,cs=ts.create({SDKAppID:e}),cs.setLogLevel(4),cs.registerPlugin({"tim-upload-plugin":as.a}))}function hs(){return btoa(ls+"/"+us.split("").reverse().join(""))}function gs(e,t,s){for(let r in t)e.off(r,t[r],s),e.on(r,t[r],s)}const fs={};class bs{constructor(e){this.bot=es().create({SDKAppID:ls}),this.groupId=e,this.name=e.replace("@TGS#","bot_"),this.init()}init(){this.bot.setLogLevel(4),this.bot.registerPlugin({"tim-upload-plugin":as.a}),gs(this.bot,{[ts.EVENT.SDK_READY]:this.onReadyStateUpdate,[ts.EVENT.SDK_NOT_READY]:this.onReadyStateUpdate,[ts.EVENT.KICKED_OUT]:this.onKickedOut,[ts.EVENT.ERROR]:this.onSdkError,[ts.EVENT.MESSAGE_RECEIVED]:this.onMessageReceived},this)}enable(){return new Promise((e,t)=>{this.bot.login({userID:this.name,userSig:window.genTestUserSig(this.name,Number(ls),us).userSig}).then(()=>{console.log("ç™»å½•æˆåŠŸ"),this.bot.joinGroup({groupID:this.groupId}).then(t=>e(t.data)).catch(e=>t(e))}).catch(e=>{console.log("ç™»å½•å¤±è´¥",e),t(e)})})}disable(){return this.bot.logout()}logout(){return this.bot.logout()}setAvatar(e){return this.bot.updateMyProfile({avatar:e})}onReadyStateUpdate({name:e}){console.log("[bot]"+e);const t=e===ts.EVENT.SDK_READY;t&&this.bot.updateMyProfile({nick:"bot"})}onSdkError(e){console.log(e.data)}onKickedOut(e){console.log("sdk kick reason "+e.data.type)}onMessageReceived({data:e}){e.forEach(e=>rs(this.bot,e))}}function vs(e){return fs[e]||(fs[e]=new bs(e)),fs[e].enable()}function ys(e){return fs[e]?fs[e].disable():new Promise(e=>e())}function Os(e,t){return fs[e]?fs[e].setAvatar(t):new Promise((e,t)=>t())}function Cs(){Object.values(fs).forEach(e=>{e.logout()})}var ws=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.member?s("el-dialog",{attrs:{title:"å¯¼å…¥äººç‰©å¡(beta)",visible:e.visible,width:"40%"},on:{close:e.onClose,"update:visible":function(t){return e.$emit("update:visible",t)}}},[s("input",{ref:"chooser",attrs:{type:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",value:"é€‰æ‹©æ–‡ä»¶"},on:{change:e.handleFile}}),s("div",[e._v("å½“å‰æ”¯æŒçš„äººç‰©å¡æ¨¡ç‰ˆï¼šCOCä¸ƒç‰ˆäººç‰©å¡v1.6.0   "),s("el-link",{attrs:{type:"primary",underline:!1,href:"/static/cocv7.xlsx"}},[e._v("ç‚¹å‡»ä¸‹è½½")])],1),s("h3",[e._v(e._s("ä¸ºç©å®¶ "+(e.member.nameCard||e.member.nick||e.member.userID)+" å¯¼å…¥äººç‰©å¡"))]),e.existedCard?s("el-alert",{attrs:{title:"è¯¥ç©å®¶å·²æœ‰äººç‰©å¡ï¼Œå†æ¬¡å¯¼å…¥å°†è¦†ç›–ä¹‹å‰çš„äººç‰©å¡",type:"warning","show-icon":"",closable:!1}}):e._e(),e.user?s("div",{staticClass:"card-data"},[s("h3",[e._v("åŸºæœ¬ä¿¡æ¯")]),s("div",[e._v(e._s(e.user.basic.name+" "+e.user.basic.gender+" "+e.user.basic.age+"å² "+e.user.basic.job))]),s("div",[e._v(e._s("ä½“åŠ› "+e.user.basic.hp+" | ç†æ™º "+e.user.basic.san+" | å¹¸è¿ "+e.user.basic.luck+" | é­”æ³• "+e.user.basic.mp))]),s("h3",[e._v("å±æ€§")]),s("div",{staticClass:"user-prop"},e._l(e.user.props,(function(t,r){return s("div",{key:r},[e._v("\n          "+e._s(r+": "+t)+"\n        ")])})),0),s("h3",[e._v("æŠ€èƒ½")]),s("div",{staticClass:"user-skill"},e._l(e.user.skills,(function(t,r){return s("div",{key:r},[e._v("\n          "+e._s(r+": "+t)+"\n        ")])})),0)]):e._e(),e.user?s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.onConfirm}},[e._v("ç¡®å®šå¯¼å…¥")])],1):e._e()],1):e._e()],1)},Ps=[],_s=s("5f5c"),Ms=s.n(_s);function Is(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function js(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Is(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Is(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Ts={props:["groupId","memberId","visible"],data(){return{user:null}},computed:js(js({},Object(y["mapState"])({existedCard:function(e){return e.game.list[this.groupId]?e.game.list[this.groupId].cards["o"+this.memberId]:null},currentMemberList:e=>e.group.currentMemberList})),{},{member(){return this.memberId?this.currentMemberList.find(e=>e.userID===this.memberId):null}}),methods:{handleFile(e){const t=e.target.files,s=t[0],r=new FileReader;r.onload=e=>{try{const t=new Uint8Array(e.target.result),s=Ms.a.read(t,{type:"array"}),r=s.Sheets[s.SheetNames[0]];this.user=ze(r)}catch(e){console.log(e),this.$store.commit("showMessage",{type:"error",message:"å¯¼å…¥å¤±è´¥ï¼Œå¯èƒ½æ˜¯æ ¼å¼ä¸æ­£ç¡®æˆ–å­—æ®µç¼ºå¤±"})}},r.readAsArrayBuffer(s)},onConfirm(){this.$store.commit("setUserCard",{groupId:this.groupId,userId:this.member.userID,card:this.user});const e=this.tim.createCustomMessage({to:this.groupId,conversationType:this.TIM.TYPES.CONV_GROUP,priority:this.TIM.TYPES.MSG_PRIORITY_HIGH,payload:{data:JSON.stringify({mtype:"card",mdata:{userId:this.member.userID,card:this.user}}),description:`ä¸»æŒäººä¸ºç©å®¶â€œ${this.member.nameCard||this.member.nick||this.member.userID}â€å¯¼å…¥äº†ä¸€å¼ äººç‰©å¡`}});this.$store.commit("pushCurrentMessageList",e),this.tim.sendMessage(e).then(()=>{this.$store.commit("showMessage",{type:"success",message:"å¯¼å…¥æˆåŠŸ"})}).catch(()=>{this.$store.commit("showMessage",{type:"error",message:"å¯¼å…¥æˆåŠŸï¼Œä½†åŒæ­¥ç»™å…¶ä»–ç¾¤æˆå‘˜å¤±è´¥ï¼Œå¯ä»¥é‡è¯•"})}),this.$emit("update:visible",!1)},onClose(){this.$refs.chooser.value="",this.user=null}}},Es=Ts,Ss=(s("3dda"),Object(d["a"])(Es,ws,Ps,!1,null,"483f9cbe",null)),Ds=Ss.exports,xs=s("0304"),ks=s.n(xs);function As(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function Gs(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?As(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):As(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var $s={data(){return{addGroupMemberVisible:!1,count:30,inviteDialogShow:!1,minacode:ks.a,importCardMemberID:null}},props:["groupProfile"],components:{CardImport:Ds},computed:Gs(Gs({},Object(y["mapState"])({currentConversation:e=>e.conversation.currentConversation,currentMemberList:e=>e.group.currentMemberList})),{},{showLoadMore(){return this.members.length<this.groupProfile.memberCount},members(){return this.currentMemberList},isOwner(){return this.groupProfile.selfInfo.role===this.TIM.TYPES.GRP_MBR_ROLE_OWNER}}),methods:{getGroupMemberAvatarText(e){switch(e){case"Owner":return"ç¾¤ä¸»";case"Admin":return"ç®¡ç†å‘˜";default:return"ç¾¤æˆå‘˜"}},getShowUserNick(e){return e.nameCard||e.nick||e.userID},getShowUserId(e){return e.userID.startsWith("bot")?"æœºå™¨äºº":e.nameCard||e.nick?e.userID:""},isBotOfThisGroup(e){return this.groupProfile.groupID.replace("@TGS#","bot_")===e.userID},getInviteQRCodeUrl(){const e=`${hs()}/${this.groupProfile.groupID.replace("@TGS#","")}`;return"https://api.pwmqr.com/qrcode/create/?url="+e},copyInviteLink(){this.$copyText(`${location.origin}/#/?s=${hs()}&g=${this.groupProfile.groupID.replace("@TGS#","")}&d=\nç‚¹å‡»é“¾æ¥åŠ å…¥ç¾¤èŠä¸€èµ·ç©~`).then(()=>{this.$store.commit("showMessage",{type:"success",message:"é‚€è¯·é“¾æ¥å¤åˆ¶æˆåŠŸï¼å¿«å‘ç»™å°ä¼™ä¼´ä»¬ä¸€èµ·ç©å§~"})}).catch(e=>{console.log("copy link error",e),this.$store.commit("showMessage",{type:"error",message:"é‚€è¯·é“¾æ¥å¤åˆ¶å¤±è´¥"})})},refreshGroupMember(){this.$store.dispatch("getGroupMemberList",this.currentConversation.groupProfile.groupID).then(()=>{this.$store.commit("showMessage",{type:"success",message:"åˆ·æ–°æˆåŠŸ"})})},setBotAvatar(e){Os(this.currentConversation.groupProfile.groupID,e).then(()=>{this.$store.commit("showMessage",{message:"ä¿®æ”¹æˆåŠŸ"})}).catch(e=>{console.log(e),this.$store.commit("showMessage",{type:"error",message:"ä¿®æ”¹å¤´åƒå¤±è´¥ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å¯ç”¨æœºå™¨äººï¼Œæœªå¯ç”¨çŠ¶æ€ä¸èƒ½ä¿®æ”¹"})})},setGroupMemberNameCard(e,t){this.tim.setGroupMemberNameCard({groupID:this.currentConversation.groupProfile.groupID,userID:e,nameCard:t}).then(()=>{this.$store.commit("showMessage",{message:"ä¿®æ”¹æˆåŠŸ"})}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},kickoutGroupMember(e){this.tim.deleteGroupMember({groupID:this.currentConversation.groupProfile.groupID,reason:"è¢«ç¾¤ä¸»è¸¢å‡º",userIDList:[e]}).then(()=>{this.$store.commit("deleteGroupMemeber",e)}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},openUserCard(e){this.$store.dispatch("openUserCard",{groupId:this.currentConversation.groupProfile.groupID,userId:e}).catch(()=>{this.$store.commit("showMessage",{type:"warning",message:"è¯¥æˆå‘˜å°šæœªå¯¼å…¥äººç‰©å¡"})})},handleDropdownCommand(e){const[t,s]=e.split(":");switch(t){case"ImportCard":this.importCardMemberID=s;break;case"SetAvatar":this.$prompt("è¯·è¾“å…¥å¤´åƒ URL","ä¿®æ”¹æœºå™¨äººå¤´åƒ",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",inputPlaceholder:"å¤´åƒ URL"}).then(({value:e})=>{this.setBotAvatar(e)}).catch(()=>{});break;case"SetNick":this.$prompt("è¯·è¾“å…¥ç¾¤åç‰‡","ä¿®æ”¹ç¾¤åç‰‡",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",inputPlaceholder:"ç¾¤åç‰‡"}).then(({value:e})=>{this.setGroupMemberNameCard(s,e)}).catch(()=>{});break;case"Kick":{const e=this.members.find(e=>e.userID===s);this.$confirm(`å°†${this.getShowUserNick(e)}è¸¢å‡ºç¾¤ç»„ï¼Ÿ`,"è¸¢å‡ºç¾¤èŠ",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(()=>{this.kickoutGroupMember(s)}).catch(()=>{});break}}}}},Ls=$s,Rs=(s("69cc"),Object(d["a"])(Ls,Zt,Xt,!1,null,"abf188ba",null)),Ns=Rs.exports,Us=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(t){e.sendBgmVisible=!0}}},[e._v("è®¾ç½®æ¸¸æˆ BGM")])],1),s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(t){e.sendTextVisible=!0}}},[e._v("å‘å¸ƒæ–‡å­—ç¬”è®°")])],1),s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$refs.noteImgPicker.click()}}},[e._v("å‘å¸ƒå›¾ç‰‡ç¬”è®°")])],1),s("input",{ref:"noteImgPicker",staticStyle:{display:"none"},attrs:{type:"file",id:"noteImgPicker",accept:".jpg, .jpeg, .png, .gif, .bmp"},on:{change:e.sendNoteImage}}),s("el-dialog",{attrs:{title:"ğŸµ è®¾ç½® BGM",visible:e.sendBgmVisible,width:"40%"},on:{"update:visible":function(t){e.sendBgmVisible=t}}},[s("div",{staticClass:"bgm-usage"},[s("div",[e._v("è®¾ç½® BGMï¼ŒBGM å°†å¯¹å…¨éƒ¨ç¾¤å‘˜å¯è§ã€‚å¦‚å¤šæ¬¡è®¾ç½®ï¼Œåˆ™ä¼šè¦†ç›–ä¹‹å‰è®¾ç½®çš„ BGMã€‚")]),s("div",[e._v("BGM é“¾æ¥éœ€ç¬¦åˆæŒ‡å®šçš„æ ¼å¼ã€‚")]),s("ul",[s("li",[e._v("ç½‘æ˜“äº‘éŸ³ä¹\n          "),s("ul",[s("li",[e._v("æ­Œå•ï¼š"),s("span",[e._v("https://music.163.com/#/playlist?id=xxxxxxx")])]),s("li",[e._v("å•æ›²ï¼š"),s("span",[e._v("https://music.163.com/#/song?id=xxxxxxx")])]),s("li",[e._v("ä¸“è¾‘ï¼š"),s("span",[e._v("https://music.163.com/#/album?id=xxxxxxx")])])])])])]),s("el-input",{attrs:{placeholder:"è¯·è¾“å…¥éŸ³ä¹é“¾æ¥"},model:{value:e.bgmLink,callback:function(t){e.bgmLink=t},expression:"bgmLink"}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.sendBgmVisible=!1}}},[e._v("å– æ¶ˆ")]),s("el-button",{attrs:{type:"primary",disabled:0===e.bgmLink.trim().length},on:{click:e.setBgm}},[e._v("ç¡® å®š")])],1)],1),s("el-dialog",{attrs:{title:"å‘å¸ƒæ–‡å­—ç¬”è®°",visible:e.sendTextVisible,width:"40%"},on:{"update:visible":function(t){e.sendTextVisible=t}}},[s("el-input",{attrs:{type:"textarea",rows:5,placeholder:"è¯·è¾“å…¥å†…å®¹"},model:{value:e.textContent,callback:function(t){e.textContent=t},expression:"textContent"}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.sendTextVisible=!1}}},[e._v("å– æ¶ˆ")]),s("el-button",{attrs:{type:"primary",disabled:0===e.textContent.trim().length},on:{click:e.sendNoteText}},[e._v("ç¡® å®š")])],1)],1)],1)},Bs=[];function Ys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function Fs(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ys(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Vs={data(){return{sendBgmVisible:!1,bgmLink:"",sendTextVisible:!1,textContent:""}},computed:Fs({},Object(y["mapState"])({groupProfile:e=>e.conversation.currentConversation.groupProfile,currentGame:e=>e.game.list[e.conversation.currentConversation.groupProfile.groupID]})),methods:{setBgm(){const e=this.bgmLink.match(/https:\/\/music\.163\.com\/#\/(playlist|song|album)\?id=(\d+)/);if(!e)return void this.$store.commit("showMessage",{type:"error",message:"é“¾æ¥æ ¼å¼ä¸æ­£ç¡®"});const t={platform:1,type:["playlist","album","song"].indexOf(e[1]),id:Number(e[2])},s=this.tim.createCustomMessage({to:this.groupProfile.groupID,conversationType:this.TIM.TYPES.CONV_GROUP,priority:this.TIM.TYPES.MSG_PRIORITY_HIGH,payload:{data:JSON.stringify({mtype:"bgm",mdata:t}),description:"ä¸»æŒäººè®¾ç½®äº†æ–°çš„ BGMï¼Œå¿«ç‚¹å‡»å³ä¾§ã€é‡è¦ç¬”è®°ã€‘é¢æ¿æŸ¥çœ‹å§"}});this._sendNoteMessage(s),this.bgmLink="",this.sendBgmVisible=!1},sendNoteText(){const e=this.tim.createTextMessage({to:this.groupProfile.groupID,conversationType:this.TIM.TYPES.CONV_GROUP,priority:this.TIM.TYPES.MSG_PRIORITY_HIGH,payload:{text:this.textContent}});this._sendNoteMessage(e),this._sendGrayTipMessage("ä¸»æŒäººå‘å¸ƒäº†ä¸€æ¡æ–°çš„ç¬”è®°ï¼Œå¿«ç‚¹å‡»å³ä¾§ã€é‡è¦ç¬”è®°ã€‘é¢æ¿æŸ¥çœ‹å§"),this.textContent="",this.sendTextVisible=!1},sendNoteImage(){const e=this.tim.createImageMessage({to:this.groupProfile.groupID,conversationType:this.TIM.TYPES.CONV_GROUP,priority:this.TIM.TYPES.MSG_PRIORITY_HIGH,payload:{file:document.getElementById("noteImgPicker")}});this._sendNoteMessage(e),this._sendGrayTipMessage("ä¸»æŒäººå‘å¸ƒäº†ä¸€æ¡æ–°çš„ç¬”è®°ï¼Œå¿«ç‚¹å‡»å³ä¾§ã€é‡è¦ç¬”è®°ã€‘é¢æ¿æŸ¥çœ‹å§"),this.$refs.noteImgPicker.value=null},_sendNoteMessage(e){this.$store.commit("pushCurrentMessageList",e),this.tim.sendMessage(e).then(()=>{this.$store.dispatch("handleKPNote",[e])}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},_sendGrayTipMessage(e){const t=this.tim.createCustomMessage({to:this.groupProfile.groupID,conversationType:this.TIM.TYPES.CONV_GROUP,payload:{data:JSON.stringify({mtype:"tip"}),description:e}});this.$store.commit("pushCurrentMessageList",t),this.tim.sendMessage(t)}}},qs=Vs,Hs=(s("8f40"),Object(d["a"])(qs,Us,Bs,!1,null,"2b33521c",null)),Ks=Hs.exports,zs=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-switch",{attrs:{value:e.currentGame.botEnabled,disabled:e.botSwitchLoading},on:{change:e.onBotSwitch}})},Js=[];function Qs(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function Ws(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Qs(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Qs(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Zs={data(){return{botSwitchLoading:!1}},computed:Ws({},Object(y["mapState"])({groupID:e=>e.conversation.currentConversation.groupProfile.groupID,currentGame:e=>e.game.list[e.conversation.currentConversation.groupProfile.groupID]})),methods:{onBotSwitch(e){this.botSwitchLoading=!0,this.$store.dispatch("toggleBotEnabled",{groupId:this.groupID,enabled:e}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:"åˆ‡æ¢æœºå™¨äººå¤±è´¥ï¼Œè¯·è”ç³»ç®¡ç†å‘˜"}),console.log("åˆ‡æ¢ bot å¤±è´¥",e)}).finally(()=>{this.botSwitchLoading=!1})}}},Xs=Zs,er=Object(d["a"])(Xs,zs,Js,!1,null,null,null),tr=er.exports,sr={props:["groupProfile"],components:{GroupMemberList:Ns,KpActions:Ks,BotSwitch:tr,ElSelect:o["Select"],ElOption:o["Option"],ElSwitch:o["Switch"]},data(){return{showEditName:!1,showEditFaceUrl:!1,showEditIntroduction:!1,showEditNotification:!1,showEditJoinOption:!1,showChangeGroupOwner:!1,showEditMessageRemindType:!1,showEditNameCard:!1,name:this.groupProfile.name,avatar:this.groupProfile.avatar,introduction:this.groupProfile.introduction,notification:this.groupProfile.notification,joinOption:this.groupProfile.joinOption,newOwnerUserID:"",messageRemindType:this.groupProfile.selfInfo.messageRemindType,nameCard:this.groupProfile.selfInfo.nameCard||"",muteAllMembers:this.groupProfile.muteAllMembers,messageRemindTypeMap:{AcceptAndNotify:"æ¥æ”¶æ¶ˆæ¯å¹¶æç¤º",AcceptNotNotify:"æ¥æ”¶æ¶ˆæ¯ä½†ä¸æç¤º",Discard:"å±è”½æ¶ˆæ¯"},joinOptionMap:{FreeAccess:"è‡ªç”±åŠ å…¥",NeedPermission:"éœ€è¦éªŒè¯",DisableApply:"ç¦æ­¢åŠ ç¾¤"},active:!1}},computed:{editable(){return this.groupProfile.type===this.TIM.TYPES.GRP_WORK||[this.TIM.TYPES.GRP_MBR_ROLE_OWNER,this.TIM.TYPES.GRP_MBR_ROLE_ADMIN].includes(this.groupProfile.selfInfo.role)},isOwner(){return this.groupProfile.selfInfo.role===this.TIM.TYPES.GRP_MBR_ROLE_OWNER},isAdmin(){return this.groupProfile.selfInfo.role===this.TIM.TYPES.GRP_MBR_ROLE_ADMIN},showDissmissGroup(){return this.isOwner&&this.groupProfile.type!==this.TIM.TYPES.GRP_WORK},groupType(){switch(this.groupProfile.type){case this.TIM.TYPES.GRP_WORK:return"å¥½å‹å·¥ä½œç¾¤ï¼ˆWorkï¼‰";case this.TIM.TYPES.GRP_PUBLIC:return"é™Œç”Ÿäººç¤¾äº¤ç¾¤ï¼ˆPublicï¼‰";case this.TIM.TYPES.GRP_CHATROOM:return"ä¸´æ—¶ä¼šè®®ç¾¤ï¼ˆMeetingï¼‰";case this.TIM.TYPES.GRP_AVCHATROOM:return"ç›´æ’­ç¾¤ï¼ˆAVChatRoomï¼‰";default:return""}}},watch:{groupProfile(e){Object.assign(this,{showEditName:!1,showEditFaceUrl:!1,showEditIntroduction:!1,showEditNotification:!1,showEditJoinOption:!1,showChangeGroupOwner:!1,showEditNameCard:!1,name:e.name,avatar:e.avatar,introduction:e.introduction,notification:e.notification,joinOption:e.joinOption,messageRemindType:e.messageRemindType,nameCard:e.selfInfo.nameCard||"",muteAllMembers:e.muteAllMembers})}},methods:{inputFocus(e){this.$nextTick(()=>{this.$refs[e].focus()})},editName(){this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,name:this.name.trim()}).then(()=>{this.showEditName=!1}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},editFaceUrl(){this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,avatar:this.avatar.trim()}).then(()=>{this.showEditFaceUrl=!1}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},changeMuteStatus(){this.isOwner||this.isAdmin?this.tim.updateGroupProfile({muteAllMembers:this.muteAllMembers,groupID:this.groupProfile.groupID}).then(e=>{this.muteAllMembers=e.data.group.muteAllMembers,this.muteAllMembers?(this.active=!0,this.$store.commit("showMessage",{message:"å…¨ä½“ç¦è¨€"})):(this.active=!1,this.$store.commit("showMessage",{message:"å–æ¶ˆå…¨ä½“ç¦è¨€"}))}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})}):(this.muteAllMembers=this.groupProfile.muteAllMembers,this.$store.commit("showMessage",{type:"error",message:"æ™®é€šç¾¤æˆå‘˜ä¸èƒ½å¯¹å…¨ä½“ç¦è¨€"}))},editIntroduction(){this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,introduction:this.introduction.trim()}).then(()=>{this.showEditIntroduction=!1}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},editNotification(){this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,notification:this.notification.trim()}).then(()=>{this.showEditNotification=!1}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},editJoinOption(){this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,joinOption:this.joinOption}).then(()=>{this.showEditJoinOption=!1}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},changeOwner(){this.tim.changeGroupOwner({groupID:this.groupProfile.groupID,newOwnerID:this.newOwnerUserID}).then(()=>{this.showChangeGroupOwner=!1,this.$store.commit("showMessage",{message:"è½¬è®©ç¾¤ä¸»æˆåŠŸï¼Œæ–°ç¾¤ä¸»IDï¼š"+this.newOwnerUserID}),this.newOwnerUserID=""}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},quitGroup(){this.tim.quitGroup(this.groupProfile.groupID).then(({data:{groupID:e}})=>{this.$store.commit("showMessage",{message:"é€€ç¾¤æˆåŠŸ"}),e===this.groupProfile.groupID&&this.$store.commit("resetCurrentConversation")}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},dismissGroup(){this.tim.dismissGroup(this.groupProfile.groupID).then(({data:{groupID:e}})=>{this.$store.commit("showMessage",{message:`ç¾¤ï¼š${this.groupProfile.name||this.groupProfile.groupID}è§£æ•£æˆåŠŸï¼`,type:"success"}),e===this.groupProfile.groupID&&this.$store.commit("resetCurrentConversation")}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},editMessageRemindType(){this.tim.setMessageRemindType({groupID:this.groupProfile.groupID,messageRemindType:this.messageRemindType}).then(()=>{this.showEditMessageRemindType=!1}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},editNameCard(){0!==this.nameCard.trim().length?this.tim.setGroupMemberNameCard({groupID:this.groupProfile.groupID,nameCard:this.nameCard.trim()}).then(()=>{this.showEditNameCard=!1}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})}):this.$store.commit("showMessage",{message:"ä¸èƒ½è®¾ç½®ç©ºçš„ç¾¤åç‰‡",type:"warning"})}}},rr=sr,ir=(s("0716"),Object(d["a"])(rr,Qt,Wt,!1,null,null,null)),or=ir.exports,nr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"profile-user"},[s("avatar",{attrs:{title:e.userProfile.userID,src:e.userProfile.avatar}}),s("div",{staticClass:"nick-name text-ellipsis"},[e.userProfile.nick?s("span",{attrs:{title:e.userProfile.nick}},[e._v("\n      "+e._s(e.userProfile.nick)+"\n    ")]):s("span",{staticClass:"anonymous",attrs:{title:"è¯¥ç”¨æˆ·æœªè®¾ç½®æ˜µç§°"}},[e._v("\n      [Anonymous]\n    ")])]),e.genderClass?s("div",{staticClass:"gender"},[s("span",{staticClass:"iconfont",class:e.genderClass,attrs:{title:e.gender}})]):e._e(),e.isInBlacklist||e.userProfile.userID===e.myUserID?e.isInBlacklist?s("el-button",{attrs:{title:"å°†è¯¥ç”¨æˆ·ç§»å‡ºé»‘åå•",type:"text"},on:{click:e.removeFromBlacklist}},[e._v("ç§»å‡ºé»‘åå•")]):e._e():s("el-button",{staticClass:"btn-add-blacklist",attrs:{title:"å°†è¯¥ç”¨æˆ·åŠ å…¥é»‘åå•",type:"text"},on:{click:e.addToBlackList}},[e._v("åŠ å…¥é»‘åå•")])],1)},ar=[];function cr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function lr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):cr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var ur={props:{userProfile:{type:Object,required:!0}},computed:lr(lr({},Object(y["mapState"])({blacklist:e=>e.blacklist.blacklist,myUserID:e=>e.user.currentUserProfile.userID})),{},{isInBlacklist(){return this.blacklist.findIndex(e=>e.userID===this.userProfile.userID)>=0},gender(){switch(this.userProfile.gender){case this.TIM.TYPES.GENDER_MALE:return"ç”·";case this.TIM.TYPES.GENDER_FEMALE:return"å¥³";default:return"æœªè®¾ç½®"}},genderClass(){switch(this.userProfile.gender){case this.TIM.TYPES.GENDER_MALE:return"icon-male";case this.TIM.TYPES.GENDER_FEMALE:return"icon-female";default:return""}}}),methods:{addToBlackList(){this.tim.addToBlacklist({userIDList:[this.userProfile.userID]}).then(()=>{this.$store.dispatch("getBlacklist")}).catch(e=>{this.$store.commit("showMessage",{message:e.message,type:"error"})})},removeFromBlacklist(){this.tim.removeFromBlacklist({userIDList:[this.userProfile.userID]}).then(()=>{this.$store.commit("removeFromBlacklist",this.userProfile.userID)}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})}}},pr=ur,mr=(s("873f"),Object(d["a"])(pr,nr,ar,!1,null,"f157254a",null)),dr=mr.exports;function hr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function gr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):hr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var fr={name:"ConversationProfile",components:{GroupProfile:or,UserProfile:dr},data(){return{}},computed:gr({},Object(y["mapState"])({currentConversation:e=>e.conversation.currentConversation}))},br=fr,vr=(s("a65e"),Object(d["a"])(br,zt,Jt,!1,null,"7e59049a",null)),yr=vr.exports,Or=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"el-fade-in"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],ref:"member-profile-card",staticClass:"member-profile-card-wrapper",style:{top:e.y+"px",left:e.x+"px"}},[s("div",{staticClass:"profile"},[s("avatar",{staticClass:"avatar",attrs:{src:e.member.avatar}}),s("div",{staticClass:"basic"},[s("span",[e._v("IDï¼š"+e._s(e.member.userID))]),s("span",[e._v("æ˜µç§°ï¼š"+e._s(e.member.nick||"æš‚æ— "))])])],1),s("el-divider",{staticClass:"divider"}),s("div",{staticClass:"member-profile"},[s("div",{staticClass:"item"},[s("span",{staticClass:"label"},[e._v("ç¾¤åç‰‡")]),e._v("\n        "+e._s(e.member.nameCard||"æš‚æ— ")+"\n      ")]),s("div",{staticClass:"item"},[s("span",{staticClass:"label"},[e._v("å…¥ç¾¤æ—¶é—´")]),e._v("\n        "+e._s(e.joinTime)+"\n      ")]),e.member.muteUntil?s("div",{staticClass:"item"},[s("span",{staticClass:"label"},[e._v("ç¦è¨€è‡³")]),e._v("\n        "+e._s(e.muteUntil)+"\n      ")]):e._e()]),s("el-button",{staticClass:"send-message-btn",attrs:{type:"primary",size:"mini",title:"å‘æ¶ˆæ¯",icon:"el-icon-message",circle:""},on:{click:e.handleSendMessage}})],1)])},Cr=[],wr={name:"MemberProfileCard",components:{ElDivider:o["Divider"]},data(){return{member:{},x:0,y:0,visible:!1}},mounted(){this.$bus.$on("showMemberProfile",this.handleShowMemberProfile,this)},computed:{joinTime(){return this.member.joinTime?Z(new Date(1e3*this.member.joinTime)):""},muteUntil(){return this.member.muteUntil?Z(new Date(1e3*this.member.muteUntil)):""}},methods:{handleSendMessage(){this.$store.dispatch("checkoutConversation","C2C"+this.member.userID),this.hide()},handleShowMemberProfile({event:e,member:t}){this.member=t||{},this.x=e.x,this.y=e.y,this.show()},show(){this.visible||(window.addEventListener("click",this.handleClick,this),this.visible=!0)},hide(){this.visible&&(window.removeEventListener("click",this.handleClick,this),this.visible=!1)},handleClick(e){e.target!==this.$refs["member-profile-card"]&&this.hide()}}},Pr=wr,_r=(s("29bd"),Object(d["a"])(Pr,Or,Cr,!1,null,"1012cb30",null)),Mr=_r.exports,Ir=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-tabs",{staticClass:"group-right-panels",attrs:{value:e.currentGame.currentTab,type:"card"},on:{input:function(t){return e.$store.commit("setCurrentTab",{groupId:e.currentConversation.groupProfile.groupID,tab:t})},"tab-click":e.handleClick,"tab-remove":e.handleRemove}},[e._l(e.allTabs,(function(t){return["group"===t?s("el-tab-pane",{key:t,attrs:{label:"ç¾¤ä¿¡æ¯",name:t}},[s("group-profile",{attrs:{groupProfile:e.currentConversation.groupProfile}})],1):"note"===t?s("el-tab-pane",{key:t,attrs:{name:t}},[s("el-badge",{attrs:{slot:"label","is-dot":"",hidden:!e.currentGame.noteUnread},slot:"label"},[e._v("é‡è¦ç¬”è®°")]),s("note-panel",{attrs:{"group-profile":e.currentConversation.groupProfile}})],1):"log"===t?s("el-tab-pane",{key:t,attrs:{label:"Log å½•åˆ¶",name:t}},[s("log-panel",{attrs:{"group-profile":e.currentConversation.groupProfile}})],1):s("el-tab-pane",{key:t,attrs:{label:e.getCardName(t),name:t,closable:!0}},[s("card-panel",{attrs:{member:t}})],1)]}))],2)},jr=[],Tr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"log-switch"},[s("div",{staticClass:"label"},[e._v("å¯ç”¨ Log")]),s("el-switch",{attrs:{value:e.currentGame.logEnabled},on:{input:function(t){return e.$store.commit("toggleLogEnabled",{groupId:e.groupProfile.groupID,enabled:t})}}})],1),s("div",{staticClass:"btn-container"},[s("el-button-group",[s("el-button",{attrs:{size:"small"},on:{click:e.exportText}},[e._v("å¯¼å‡ºä¸ºæ–‡æœ¬")]),s("el-button",{attrs:{size:"small"},on:{click:e.exportHTML}},[e._v("å¯¼å‡ºä¸ºHTML")]),s("el-button",{attrs:{size:"small"},on:{click:e.exportJson}},[e._v("å¯¼å‡ºä¸ºJSON")]),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.clearAllLogs}},[e._v("æ¸…ç©º")])],1)],1),s("draggable",{staticClass:"log-container",attrs:{handle:".handle","ghost-class":"moving",value:e.currentGame.logs},on:{input:function(t){return e.$store.commit("updateLogs",{groupId:e.groupProfile.groupID,logs:t})}}},e._l(e.currentGame.logs,(function(t){return s("div",{key:t.id,staticClass:"log-item"},[s("div",[s("i",{staticClass:"el-icon-rank handle"}),s("div",{staticClass:"nick",attrs:{title:t.from}},[e._v(e._s(t.nick||t.from))]),s("div",{staticClass:"content",attrs:{title:e.formatTime(t.time)}},[e._v(e._s(t.content))])]),s("i",{staticClass:"el-icon-close delete",on:{click:function(s){return e.onDeleteLog(t.id)}}})])})),0)],1)},Er=[],Sr=s("b76a"),Dr=s.n(Sr);function xr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function kr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):xr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const Ar="\n.chat-item {\n    padding: 4px;\n}\n\n.chat-item-name {\n    font-weight: bold;\n}\n\n.chat-user-bot {\n    background-color: #ffffe0;\n}\n/* xxx æ›¿æ¢æˆå®é™…çš„ userid */\n.chat-user-xxx {\n    background-color: #e0ffff;\n}";var Gr={props:["groupProfile"],components:{ElSwitch:o["Switch"],draggable:Dr.a},computed:kr({},Object(y["mapState"])({currentGame:e=>e.game.list[e.conversation.currentConversation.groupProfile.groupID]})),methods:{formatTime(e){return Z(new Date(1e3*e))},onDeleteLog(e){this.$store.commit("updateLogs",{groupId:this.groupProfile.groupID,logs:this.currentGame.logs.filter(t=>t.id!==e)})},clearAllLogs(){this.$store.commit("updateLogs",{groupId:this.groupProfile.groupID,logs:[]})},exportText(){let e="",t="";this.currentGame.logs.forEach(s=>{let r=s.nick||s.from;r!==e&&(t+=`${r} ${this.formatTime(s.time)}\n`),t+=s.content+"\n",e=r}),this.download("text",t)},exportHTML(){let e="",t="";this.currentGame.logs.forEach(s=>{let r=s.nick||s.from;r!==e?(""!==t&&(t+="</div>"),t+=`<div class='chat-item chat-user-${s.from}'><div class='meta'><span class='chat-item-name'>${r}</span><span class='chat-item-time'>${this.formatTime(s.time)}</span></div><div class='content'>${s.content}</div>`):t+=`<div class='content'>${s.content}</div>`,e=r}),""!==t&&(t+="</div>"),t+=`<style>${Ar}</style>`,this.download("html",t)},exportJson(){this.download("json",JSON.stringify(this.currentGame.logs))},download(e,t){const s=document.createElement("a");s.setAttribute("href",`data:${e}/plain;charset=utf-8,`+encodeURIComponent(t)),s.setAttribute("download","log."+("text"===e?"txt":e)),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}}},$r=Gr,Lr=(s("b371"),Object(d["a"])($r,Tr,Er,!1,null,"282200b2",null)),Rr=Lr.exports,Nr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-alert",{attrs:{title:"ä¸»æŒäººå‘å¸ƒçš„é‡è¦ç¬”è®°å°†ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ",type:"info",description:"ä½ ä¹Ÿå¯ä»¥æŠŠè‡ªå·±è§‰å¾—é‡è¦çš„æ¶ˆæ¯æ”¶è—åœ¨è¿™é‡Œï¼ˆæ•¬è¯·æœŸå¾…ï¼‰","show-icon":""}}),s("bgm",{attrs:{bgm:e.currentGame.bgm}}),s("draggable",{staticClass:"card-list",attrs:{"ghost-class":"moving",value:e.currentGame.notes},on:{input:function(t){return e.$store.commit("updateNotes",{groupId:e.groupProfile.groupID,notes:t})}}},e._l(e.currentGame.notes,(function(t){return s("el-card",{key:t.id,staticClass:"card",attrs:{shadow:"hover"}},[t.type===e.TIM.TYPES.MSG_TEXT?s("div",{staticClass:"note-text"},[e._v(e._s(t.payload))]):t.type===e.TIM.TYPES.MSG_IMAGE?s("img",{staticClass:"note-img",attrs:{src:e.formatUrl(t.payload)},on:{click:function(s){return e.handlePreview(t.payload)}}}):e._e(),s("div",{staticClass:"tools"},[s("el-button",{attrs:{icon:"el-icon-copy-document",size:"mini",circle:""},on:{click:function(s){return e.handleCopyCard(t.payload)}}}),s("el-button",{attrs:{icon:"el-icon-close",size:"mini",circle:""},on:{click:function(s){return e.handleDelete(t.id)}}})],1)])})),1)],1)},Ur=[],Br=function(){var e=this,t=e.$createElement,s=e._self._c||t;return 1===e.bgm.platform?s("iframe",{key:e.bgm.id,staticClass:"player",attrs:{frameborder:"no",border:"0",marginwidth:"0",marginheight:"0",height:2===e.bgm.type?110:235,src:"//music.163.com/outchain/player?type="+e.bgm.type+"&id="+e.bgm.id}}):e._e()},Yr=[],Fr={props:["bgm"]},Vr=Fr,qr=(s("831a"),Object(d["a"])(Vr,Br,Yr,!1,null,"33e8d0dc",null)),Hr=qr.exports;function Kr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function zr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Kr(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Kr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Jr={props:["groupProfile"],components:{bgm:Hr,draggable:Dr.a},computed:zr({},Object(y["mapState"])({currentGame:e=>e.game.list[e.conversation.currentConversation.groupProfile.groupID]})),methods:{formatUrl(e){return"//"===e.slice(0,2)?"https:"+e:e},handlePreview(e){this.$bus.$emit("image-preview",{url:e})},handleCopyCard(e){this.$copyText(e).then(()=>{this.$store.commit("showMessage",{type:"success",message:"å¤åˆ¶æˆåŠŸ"})})},handleDelete(e){const t=this.currentGame.notes.filter(t=>t.id!==e);this.$store.commit("updateNotes",{groupId:this.groupProfile.groupID,notes:t})}}},Qr=Jr,Wr=(s("7f69"),Object(d["a"])(Qr,Nr,Ur,!1,null,"5cb73abc",null)),Zr=Wr.exports,Xr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{padding:"20px"}},[s("div",{staticClass:"simple-info"},[s("div",[e._v(e._s(e.currentCard.basic.name))]),s("div",[e._v(e._s(e.currentCard.basic.gender))]),s("div",[e._v(e._s(e.currentCard.basic.age+"å²"))]),s("div",[e._v(e._s(e.currentCard.basic.job))])]),e._m(0),s("el-table",{attrs:{data:[e.currentCard.basic],"row-class-name":"row","header-row-class-name":"row"},on:{"cell-click":e.onBasicClick}},[s("el-table-column",{attrs:{prop:"hp",label:"ä½“åŠ›"}}),s("el-table-column",{attrs:{prop:"san",label:"ç†æ™º"}}),s("el-table-column",{attrs:{prop:"luck",label:"å¹¸è¿"}}),s("el-table-column",{attrs:{prop:"mp",label:"é­”æ³•"}})],1),s("div",{staticClass:"section"},[s("h4",{staticClass:"section-title"},[e._v("åŸºç¡€å±æ€§")]),s("el-input",{staticStyle:{width:"150px"},attrs:{clearable:"","prefix-icon":"el-icon-search",size:"mini"},model:{value:e.searchProp,callback:function(t){e.searchProp=t},expression:"searchProp"}})],1),s("el-table",{attrs:{data:e.filterProps(),stripe:"","row-class-name":"row","header-row-class-name":"row"},on:{"cell-click":e.onCellClick}},[s("el-table-column",{attrs:{prop:"name",label:"å±æ€§"}}),s("el-table-column",{attrs:{prop:"value",sortable:"",label:"%"}}),s("el-table-column",{attrs:{label:"åŠå€¼"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(Math.floor(t.row.value/2)))]}}])}),s("el-table-column",{attrs:{label:"1/5å€¼"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(Math.floor(t.row.value/5)))]}}])})],1),s("div",{staticClass:"section"},[s("h4",{staticClass:"section-title"},[e._v("æŠ€èƒ½è¡¨")]),s("el-input",{staticStyle:{width:"150px"},attrs:{clearable:"","prefix-icon":"el-icon-search",size:"mini"},model:{value:e.searchSkill,callback:function(t){e.searchSkill=t},expression:"searchSkill"}})],1),s("el-table",{attrs:{data:e.filterSkills(),stripe:"","row-class-name":"row","header-row-class-name":"row"},on:{"cell-click":e.onCellClick}},[s("el-table-column",{attrs:{type:"selection",width:"30","class-name":"select-col"}}),s("el-table-column",{attrs:{prop:"name",label:"å±æ€§",width:"105"}}),s("el-table-column",{attrs:{prop:"value",sortable:"",label:"%"}}),s("el-table-column",{attrs:{label:"åŠå€¼"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(Math.floor(t.row.value/2)))]}}])}),s("el-table-column",{attrs:{label:"1/5å€¼"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(Math.floor(t.row.value/5)))]}}])})],1)],1)},ei=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tips"},[e._v("ç‚¹å‡»ä¸‹æ–¹å¯¹åº”çš„æ•°å€¼æ ¼å­å¯ä»¥å¿«é€ŸæŠ•éª°ï¼›\n    "),s("br"),e._v("ç‚¹å‡»å±æ€§åç§°å¯ä»¥å¤åˆ¶ï¼›\n    "),s("br"),e._v("ç‚¹å‡»è¡¨å¤´å¯ä»¥å°†å±æ€§å’ŒæŠ€èƒ½æŒ‰æˆåŠŸç‡æ’åºï¼›\n    "),s("br"),e._v("å¯æŒ‰ä¸­æ–‡æˆ–æ‹¼éŸ³é¦–å­—æ¯æœç´¢ã€‚\n  ")])}],ti=s("a095"),si=s.n(ti);function ri(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function ii(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ri(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ri(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var oi={props:["member"],data(){return{searchProp:"",searchSkill:""}},computed:ii(ii({},Object(y["mapState"])({currentGame:e=>e.game.list[e.conversation.currentConversation.groupProfile.groupID],currentCard:function(){return this.currentGame.cards["o"+this.member]}})),{},{props:function(){return Object.keys(this.currentCard.props).map(e=>({name:e,value:this.currentCard.props[e],pinyin:si.a.spell(e,"first","low")}))},skills:function(){return Object.keys(this.currentCard.skills).map(e=>({name:e,value:this.currentCard.skills[e],pinyin:si.a.spell(e,"first","low")}))}}),methods:{filterProps(){return""===this.searchProp?this.props:this.props.filter(e=>e.name.includes(this.searchProp)||e.pinyin.includes(this.searchProp.toLowerCase()))},filterSkills(){return""===this.searchSkill?this.skills:this.skills.filter(e=>e.name.includes(this.searchSkill)||e.pinyin.includes(this.searchSkill.toLowerCase()))},onCellClick(e,t){if("å±æ€§"===t.label)return void this.$copyText(e.name).then(()=>{this.$store.commit("showMessage",{type:"success",message:"å¤åˆ¶æˆåŠŸ"})});let s="åŠå€¼"===t.label?"å›°éš¾":"1/5å€¼"===t.label?"æéš¾":"",r=document.getElementById("ghost-message-send-box");r.innerText=".d% "+s+e.name,r.click()},onBasicClick(e,t){if("ç†æ™º"===t.label||"å¹¸è¿"===t.label){let e=document.getElementById("ghost-message-send-box");e.innerText=".d% "+t.label,e.click()}}}},ni=oi,ai=(s("d2b0"),Object(d["a"])(ni,Xr,ei,!1,null,"e8acf376",null)),ci=ai.exports,li=s("a352"),ui=s.n(li);function pi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function mi(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?pi(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):pi(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var di={name:"RightPanel",components:{LogPanel:Rr,NotePanel:Zr,CardPanel:ci,GroupProfile:or},data(){return{activeName:"group"}},computed:mi({},Object(y["mapState"])({currentConversation:e=>e.conversation.currentConversation,currentGame:e=>e.game.list[e.conversation.currentConversation.groupProfile.groupID],allTabs(){return this.currentGame.openedCards}})),mounted(){const e=document.querySelector(".group-right-panels div[role=tablist]");ui.a.create(e,{onEnd:({newIndex:e,oldIndex:t})=>{const s=this.allTabs.splice(t,1)[0];this.allTabs.splice(e,0,s),this.$store.commit("setOpenedUserCards",{groupId:this.currentConversation.groupProfile.groupID,list:this.allTabs})}})},methods:{handleClick(e){"note"===e.name&&this.$store.commit("setNoteUnread",{groupId:this.currentConversation.groupProfile.groupID,unread:!1})},handleRemove(e){this.$store.dispatch("closeUserCard",{groupId:this.currentConversation.groupProfile.groupID,userId:e})},getCardName(e){return this.currentGame.cards["o"+e].basic.name}}},hi=di,gi=(s("3e62"),Object(d["a"])(hi,Ir,jr,!1,null,"5f0bd0fa",null)),fi=gi.exports;function bi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function vi(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?bi(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):bi(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var yi={name:"CurrentConversation",components:{MessageSendBox:N,MessageItem:Kt,ConversationProfile:yr,MemberProfileCard:Mr,RightPanel:fi},data(){return{isShowScrollButtomTips:!1,preScrollHeight:0,showConversationProfile:!0,timeout:""}},computed:vi(vi(vi({},Object(y["mapState"])({currentConversation:e=>e.conversation.currentConversation,currentUnreadCount:e=>e.conversation.currentConversation.unreadCount,currentMessageList:e=>e.conversation.currentMessageList,isCompleted:e=>e.conversation.isCompleted})),Object(y["mapGetters"])(["toAccount","hidden"])),{},{showCurrentConversation(){return!!this.currentConversation.conversationID},name(){return"C2C"===this.currentConversation.type?this.currentConversation.userProfile.nick||this.toAccount:"GROUP"===this.currentConversation.type?this.currentConversation.groupProfile.name||this.toAccount:"@TIM#SYSTEM"===this.currentConversation.conversationID?"ç³»ç»Ÿé€šçŸ¥":this.toAccount},showMessageSendBox(){return this.currentConversation.type!==this.TIM.TYPES.CONV_SYSTEM}}),mounted(){if(this.$bus.$on("image-loaded",this.onImageLoaded),this.$bus.$on("scroll-bottom",this.scrollMessageListToButtom),"@TIM#SYSTEM"===this.currentConversation.conversationID)return!1},updated(){this.keepMessageListOnButtom()},watch:{currentUnreadCount(e){!this.hidden&&e>0&&this.tim.setMessageRead({conversationID:this.currentConversation.conversationID})},hidden(e){!e&&this.currentUnreadCount>0&&this.tim.setMessageRead({conversationID:this.currentConversation.conversationID})}},methods:{onScroll({target:{scrollTop:e}}){let t=this.$refs["message-list"];t&&this.preScrollHeight-t.clientHeight-e<20&&(this.isShowScrollButtomTips=!1)},keepMessageListOnButtom(){let e=this.$refs["message-list"];e&&(this.preScrollHeight-e.clientHeight-e.scrollTop<20?(this.$nextTick(()=>{e.scrollTop=e.scrollHeight}),this.isShowScrollButtomTips=!1):this.isShowScrollButtomTips=!0,this.preScrollHeight=e.scrollHeight)},scrollMessageListToButtom(){this.$nextTick(()=>{let e=this.$refs["message-list"];e&&(e.scrollTop=e.scrollHeight,this.preScrollHeight=e.scrollHeight,this.isShowScrollButtomTips=!1)})},showMore(){this.showConversationProfile=!this.showConversationProfile},onImageLoaded(){this.keepMessageListOnButtom()}}},Oi=yi,Ci=(s("4c27"),Object(d["a"])(Oi,C,w,!1,null,"44982faf",null)),wi=Ci.exports,Pi=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"side-bar-wrapper"},[s("div",{staticClass:"bar-left"},[s("div",{staticClass:"tab-items",on:{click:e.handleClick}},[s("div",{staticClass:"iconfont icon-conversation",class:{active:e.showConversationList},attrs:{id:"conversation-list",title:"ä¼šè¯åˆ—è¡¨"}},[0!==e.totalUnreadCount?s("sup",{staticClass:"unread"},[e.totalUnreadCount>99?[e._v("99+")]:[e._v(e._s(e.totalUnreadCount))]],2):e._e()]),s("div",{staticClass:"iconfont icon-group",class:{active:e.showGroupList},attrs:{id:"group-list",title:"ç¾¤ç»„åˆ—è¡¨"}}),s("div",{staticClass:"iconfont icon-blacklist",class:{active:e.showBlackList},attrs:{id:"black-list",title:"é»‘åå•åˆ—è¡¨"}})]),s("div",{staticClass:"bottom"},[s("div",{staticClass:"iconfont icon-zidingyi",attrs:{title:"è®¾ç½®"},on:{click:function(t){e.globalSettingsVisible=!0}}}),s("global-setting",{attrs:{visible:e.globalSettingsVisible},on:{"update:visible":function(t){e.globalSettingsVisible=t}}}),s("div",{staticClass:"iconfont icon-tuichu",attrs:{title:"é€€å‡º"},on:{click:e.handleExit}})],1)]),s("div",{staticClass:"bar-right"},[s("conversation-list",{directives:[{name:"show",rawName:"v-show",value:e.showConversationList,expression:"showConversationList"}]}),s("group-list",{directives:[{name:"show",rawName:"v-show",value:e.showGroupList,expression:"showGroupList"}]}),s("friend-list",{directives:[{name:"show",rawName:"v-show",value:e.showFriendList,expression:"showFriendList"}]}),s("black-list",{directives:[{name:"show",rawName:"v-show",value:e.showBlackList,expression:"showBlackList"}]})],1)])},_i=[],Mi=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"list-container"},[s("div",{staticClass:"scroll-container"},e._l(e.conversationList,(function(e){return s("conversation-item",{key:e.conversationID,attrs:{conversation:e}})})),1)])},Ii=[],ji=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"conversation-item-container",class:{choose:e.conversation.conversationID===e.currentConversation.conversationID},on:{click:e.selectConversation}},[s("div",{staticClass:"close-btn"},[s("span",{staticClass:"tim-icon-close",attrs:{title:"åˆ é™¤ä¼šè¯"},on:{click:e.deleteConversation}})]),s("div",{staticClass:"warp"},[s("avatar",{attrs:{src:e.avatar,type:e.conversation.type}}),s("div",{staticClass:"content"},[s("div",{staticClass:"row-1"},[s("div",{staticClass:"name"},[s("div",{staticClass:"text-ellipsis"},[e.conversation.type===e.TIM.TYPES.CONV_C2C?s("span",{attrs:{title:e.conversation.userProfile.nick||e.conversation.userProfile.userID}},[e._v(e._s(e.conversation.userProfile.nick||e.conversation.userProfile.userID)+"\n            ")]):e.conversation.type===e.TIM.TYPES.CONV_GROUP?s("span",{attrs:{title:e.conversation.groupProfile.name||e.conversation.groupProfile.groupID}},[e._v(e._s(e.conversation.groupProfile.name||e.conversation.groupProfile.groupID)+"\n            ")]):e.conversation.type===e.TIM.TYPES.CONV_SYSTEM?s("span",[e._v("ç³»ç»Ÿé€šçŸ¥\n            ")]):e._e()])]),s("div",{staticClass:"unread-count"},[e.showUnreadCount?s("span",{staticClass:"badge"},[e._v("\n            "+e._s(e.conversation.unreadCount>99?"99+":e.conversation.unreadCount)+"\n          ")]):e._e()])]),s("div",{staticClass:"row-2"},[s("div",{staticClass:"summary"},[e.conversation.lastMessage?s("div",{staticClass:"text-ellipsis"},[e.hasMessageAtMe?s("span",{staticClass:"remind",staticStyle:{color:"red"}},[e._v("[æœ‰äººæåˆ°æˆ‘]")]):e._e(),s("span",{staticClass:"text",attrs:{title:e.conversation.lastMessage.messageForShow}},[e._v("\n              "+e._s(e.messageForShow)+"\n            ")])]):e._e()]),s("div",{staticClass:"date"},[e._v("\n          "+e._s(e.date)+"\n        ")])])])],1)])},Ti=[];function Ei(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function Si(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ei(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ei(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Di={name:"conversation-item",props:["conversation"],data(){return{popoverVisible:!1,hasMessageAtMe:!1}},computed:Si(Si({showUnreadCount(){return(this.$store.getters.hidden||this.currentConversation.conversationID!==this.conversation.conversationID)&&this.conversation.unreadCount>0},date(){if(!this.conversation.lastMessage||!this.conversation.lastMessage.lastTime)return"";const e=new Date(1e3*this.conversation.lastMessage.lastTime);return X(e)?W(e):Q(e)},avatar:function(){switch(this.conversation.type){case"GROUP":return this.conversation.groupProfile.avatar;case"C2C":return this.conversation.userProfile.avatar;default:return""}},conversationName:function(){return this.conversation.type===this.TIM.TYPES.CONV_C2C?this.conversation.userProfile.nick||this.conversation.userProfile.userID:this.conversation.type===this.TIM.TYPES.CONV_GROUP?this.conversation.groupProfile.name||this.conversation.groupProfile.groupID:this.conversation.type===this.TIM.TYPES.CONV_SYSTEM?"ç³»ç»Ÿé€šçŸ¥":""},showGrayBadge(){return this.conversation.type===this.TIM.TYPES.CONV_GROUP&&"AcceptNotNotify"===this.conversation.groupProfile.selfInfo.messageRemindType},messageForShow(){return this.conversation.lastMessage.isRevoked?this.conversation.lastMessage.fromAccount===this.currentUserProfile.userID?"ä½ æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯":this.conversation.type===this.TIM.TYPES.CONV_C2C?"å¯¹æ–¹æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯":this.conversation.lastMessage.fromAccount+"æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯":this.conversation.lastMessage.messageForShow}},Object(y["mapState"])({currentConversation:e=>e.conversation.currentConversation,currentUserProfile:e=>e.user.currentUserProfile})),Object(y["mapGetters"])(["toAccount"])),mounted(){this.$bus.$on("new-messsage-at-me",e=>{e.data.conversationID===this.conversation.conversationID&&this.conversation.conversationID!==this.currentConversation.conversationID&&(this.hasMessageAtMe=!0)})},methods:{selectConversation(){this.conversation.conversationID!==this.currentConversation.conversationID&&this.$store.dispatch("checkoutConversation",this.conversation.conversationID)},deleteConversation(e){e.stopPropagation(),this.tim.deleteConversation(this.conversation.conversationID).then(()=>{this.$store.commit("showMessage",{message:`ä¼šè¯ã€${this.conversationName}ã€‘åˆ é™¤æˆåŠŸ!`,type:"success"}),this.popoverVisible=!1,this.$store.commit("resetCurrentConversation")}).catch(e=>{this.$store.commit("showMessage",{message:`ä¼šè¯ã€${this.conversationName}ã€‘åˆ é™¤å¤±è´¥!, error=${e.message}`,type:"error"}),this.popoverVisible=!1})},showContextMenu(){this.popoverVisible=!0}},watch:{currentConversation(e){e.conversationID===this.conversation.conversationID&&(this.hasMessageAtMe=!1)}}},xi=Di,ki=(s("15aa"),Object(d["a"])(xi,ji,Ti,!1,null,"1e828726",null)),Ai=ki.exports;function Gi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function $i(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Gi(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Gi(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Li={name:"ConversationList",components:{ConversationItem:Ai},data(){return{showDialog:!1,userID:"",isCheckouting:!1,timeout:null}},computed:$i({},Object(y["mapState"])({conversationList:e=>e.conversation.conversationList,currentConversation:e=>e.conversation.currentConversation})),mounted(){window.addEventListener("keydown",this.handleKeydown)},destroyed(){window.removeEventListener("keydown",this.handleKeydown)},methods:{handleRefresh(){this.refreshConversation()()},refreshConversation(){let e=this;return function(){e.timeout||(e.timeout=setTimeout(()=>{e.timeout=null,e.tim.getConversationList().then(()=>{e.$store.commit("showMessage",{message:"åˆ·æ–°æˆåŠŸ",type:"success"})})},1e3))}},handleAddButtonClick(){this.showDialog=!0},handleKeydown(e){if(38!==e.keyCode&&40!==e.keyCode||this.isCheckouting)return;const t=this.conversationList.findIndex(e=>e.conversationID===this.currentConversation.conversationID);38===e.keyCode&&t-1>=0&&this.checkoutPrev(t),40===e.keyCode&&t+1<this.conversationList.length&&this.checkoutNext(t)},checkoutPrev(e){this.isCheckouting=!0,this.$store.dispatch("checkoutConversation",this.conversationList[e-1].conversationID).then(()=>{this.isCheckouting=!1}).catch(()=>{this.isCheckouting=!1})},checkoutNext(e){this.isCheckouting=!0,this.$store.dispatch("checkoutConversation",this.conversationList[e+1].conversationID).then(()=>{this.isCheckouting=!1}).catch(()=>{this.isCheckouting=!1})}}},Ri=Li,Ni=(s("c16a"),Object(d["a"])(Ri,Mi,Ii,!1,null,"ce3bcfe8",null)),Ui=Ni.exports,Bi=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"list-container"},[s("div",{staticClass:"group-container"},e._l(e.groupList,(function(e){return s("group-item",{key:e.groupID,attrs:{group:e}})})),1)])},Yi=[],Fi=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-form",{ref:"createGroupForm",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"ç¾¤åç§°",prop:"name"}},[s("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),s("el-form-item",{attrs:{label:"ç¾¤å¤´åƒåœ°å€"}},[s("el-input",{model:{value:e.form.avatar,callback:function(t){e.$set(e.form,"avatar",t)},expression:"form.avatar"}})],1)],1),s("div",{staticClass:"dialog-footer",style:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.closeCreateGroupModel}},[e._v("å– æ¶ˆ")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("createGroupForm")}}},[e._v("ç«‹å³åˆ›å»º")])],1)],1)},Vi=[];function qi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function Hi(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?qi(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):qi(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Ki={components:{ElForm:o["Form"],ElFormItem:o["FormItem"],ElInput:o["Input"],ElSelect:o["Select"],ElOption:o["Option"],ElRadioGroup:o["RadioGroup"],ElRadio:o["Radio"]},data(){return{form:{groupID:"",name:"",type:this.TIM.TYPES.GRP_PUBLIC,avatar:"",introduction:"",notification:"",joinOption:"FreeAccess",memberList:[]},options:[],loading:!1,rules:{name:[{required:!0,message:"è¯·è¾“å…¥ç¾¤åç§°",trigger:"blur"}]}}},computed:{joinOptionDisabled(){return[this.TIM.TYPES.GRP_WORK,this.TIM.TYPES.GRP_MEETING,this.TIM.TYPES.GRP_AVCHATROOM].includes(this.form.type)}},methods:{onSubmit(e){this.$refs[e].validate(e=>{if(!e)return!1;this.createGroup()})},closeCreateGroupModel(){this.$store.commit("updateCreateGroupModelVisible",!1)},createGroup(){this.tim.createGroup(this.getOptions()).then(e=>{this.$store.commit("showMessage",{message:`ç¾¤ç»„ï¼šã€${e.data.group.name}ã€‘åˆ›å»ºæˆåŠŸ`,type:"success"}),this.closeCreateGroupModel()}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},getOptions(){let e=Hi(Hi({},this.form),{},{memberList:this.form.memberList.map(e=>({userID:e}))});return[this.TIM.TYPES.GRP_WORK,this.TIM.TYPES.GRP_AVCHATROOM].includes(this.form.type)&&delete e.joinOption,e},handleSearchUser(e){""!==e&&(this.loading=!0,this.tim.getUserProfile({userIDList:[e]}).then(({data:e})=>{this.options=e.map(e=>e.userID),this.loading=!1}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})}))}}},zi=Ki,Ji=Object(d["a"])(zi,Fi,Vi,!1,null,"50ee1526",null),Qi=Ji.exports,Wi=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"scroll-container",on:{click:e.handleGroupClick}},[s("div",{staticClass:"group-item"},[s("avatar",{attrs:{src:e.group.avatar}}),s("div",{staticClass:"group-name text-ellipsis"},[e._v(e._s(e.group.name))])],1)])},Zi=[],Xi={props:["group"],data(){return{visible:!1,options:[{text:"é€€å‡ºç¾¤ç»„",handler:this.quitGroup}]}},methods:{handleGroupClick(){const e="GROUP"+this.group.groupID;this.$store.dispatch("checkoutConversation",e)},quitGroup(){this.tim.quitGroup(this.group.groupID).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})}}},eo=Xi,to=(s("2054"),Object(d["a"])(eo,Wi,Zi,!1,null,"64a02b1a",null)),so=to.exports;function ro(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function io(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ro(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ro(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var oo={data(){return{groupID:"",hideSearchLoading:!0}},components:{GroupItem:so,ElDialog:o["Dialog"],CreateGroup:Qi,ElAutocomplete:o["Autocomplete"]},computed:io({groupList:function(){return this.$store.state.group.groupList}},Object(y["mapState"])({createGroupModelVisible:e=>e.group.createGroupModelVisible})),methods:{onGroupUpdated(e){this.$store.dispatch("updateGroupList",e)},createGroup(){},closeCreateGroupModel(){this.$store.commit("updateCreateGroupModelVisible",!1)},searchGroupByID(e,t){e.trim().length>0?(this.hideSearchLoading=!1,this.tim.searchGroupByID(e).then(({data:{group:e}})=>{t([e])}).catch(()=>{this.$store.commit("showMessage",{message:"æ²¡æœ‰æ‰¾åˆ°è¯¥ç¾¤",type:"error"})})):this.hideSearchLoading=!0},showCreateGroupModel(){this.$store.commit("updateCreateGroupModelVisible",!0)},applyJoinGroup(e){this.tim.joinGroup({groupID:e.groupID}).then(async e=>{switch(e.data.status){case this.TIM.TYPES.JOIN_STATUS_WAIT_APPROVAL:this.$store.commit("showMessage",{message:"ç”³è¯·æˆåŠŸï¼Œç­‰å¾…ç¾¤ç®¡ç†å‘˜ç¡®è®¤ã€‚",type:"info"});break;case this.TIM.TYPES.JOIN_STATUS_SUCCESS:await this.$store.dispatch("checkoutConversation","GROUP"+e.data.group.groupID),this.$store.commit("showMessage",{message:"åŠ ç¾¤æˆåŠŸ",type:"success"});break;case this.TIM.TYPES.JOIN_STATUS_ALREADY_IN_GROUP:this.$store.commit("showMessage",{message:"æ‚¨å·²ç»æ˜¯ç¾¤æˆå‘˜äº†ï¼Œè¯·å‹¿é‡å¤åŠ ç¾¤å“¦ï¼",type:"info"});break;default:break}}).catch(e=>{this.$store.commit("showMessage",{message:e.message,type:"error"})})}}},no=oo,ao=(s("7ba6"),Object(d["a"])(no,Bi,Yi,!1,null,"4dedbdfc",null)),co=ao.exports,lo=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"friend-list-container",class:{default:!e.hasFriend}},[e.hasFriend?s("div",e._l(e.friendList,(function(e){return s("friend-item",{key:e.userID,attrs:{friend:e}})})),1):s("div",{staticStyle:{color:"gray"}},[e._v("æš‚æ— å¥½å‹")])])},uo=[],po=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{staticClass:"friend-item-container"},[s("el-col",{attrs:{span:6}},[s("avatar",{attrs:{src:e.friend.profile.avatar}})],1),s("el-col",{attrs:{span:18}},[s("div",{staticClass:"friend-name"},[e._v(e._s(e.friend.profile.nick||e.friend.userID))])])],1)],1)},mo=[],ho={props:{friend:{type:Object,required:!0}},methods:{handleFriendClick(){this.tim.getConversationProfile("C2C"+this.friend.userID).then(({data:e})=>{this.$store.commit("updateCurrentConversation",e)}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})}}},go=ho,fo=Object(d["a"])(go,po,mo,!1,null,"0e5cffba",null),bo=fo.exports;function vo(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function yo(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?vo(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):vo(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Oo={components:{FriendItem:bo},computed:yo(yo({},Object(y["mapState"])({friendList:e=>e.friend.friendList})),{},{hasFriend(){return this.friendList.length>0}})},Co=Oo,wo=(s("47b1"),Object(d["a"])(Co,lo,uo,!1,null,null,null)),Po=wo.exports,_o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"blacklist-wrapper",class:{default:!e.hasBlacklist}},[e.hasBlacklist?s("div",e._l(e.blacklist,(function(e){return s("blacklist-item",{key:e.userID,attrs:{profile:e}})})),1):s("span",{staticStyle:{color:"gray"}},[e._v("é»‘åå•è¿˜æ˜¯ç©ºçš„")])])},Mo=[],Io=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"blacklist-item-wrapper"},[s("img",{staticClass:"avatar",attrs:{src:e.profile.avatar?e.profile.avatar:"http://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png"}}),s("div",{staticClass:"item"},[e._v(e._s(e.profile.nick||e.profile.userID))]),s("el-button",{attrs:{type:"text"},on:{click:e.removeFromBlacklist}},[e._v("å–æ¶ˆæ‹‰é»‘")])],1)},jo=[],To={name:"BlacklistItem",props:{profile:{type:Object,required:!0}},methods:{removeFromBlacklist(){this.tim.removeFromBlacklist({userIDList:[this.profile.userID]}).then(()=>{this.$store.commit("removeFromBlacklist",this.profile.userID)}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})}}},Eo=To,So=(s("b849"),Object(d["a"])(Eo,Io,jo,!1,null,"6763cfe2",null)),Do=So.exports;function xo(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function ko(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?xo(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):xo(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Ao={name:"Blacklist",components:{BlacklistItem:Do},computed:ko(ko({},Object(y["mapState"])({blacklist:e=>e.blacklist.blacklist})),{},{hasBlacklist(){return this.blacklist.length>0}})},Go=Ao,$o=(s("86b5"),Object(d["a"])(Go,_o,Mo,!1,null,"00ad617d",null)),Lo=$o.exports,Ro=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"å…¨å±€è®¾ç½®",width:"40%",visible:e.visible},on:{close:function(t){return e.$emit("update:visible",!1)}}},[s("div",{staticClass:"settings-content"},[s("div",[e._v("ã€é‡è¦ç¬”è®°ã€‘/ã€Logã€‘/ã€äººç‰©å¡ã€‘çš„å†…å®¹ï¼Œä¼šç¼“å­˜åœ¨æœ¬åœ°ï¼Œè¿™æ ·åœ¨ä¸‹æ¬¡æ‰“å¼€æ—¶ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚")]),s("div",[e._v("å¦‚æœä½ å·²ç»ä¸éœ€è¦è¿™äº›ç¼“å­˜äº†ï¼Œå¯ä»¥å°†å…¶æ¸…é™¤ï¼Œä»¥é‡Šæ”¾å­˜å‚¨ç©ºé—´ã€æå‡åˆå§‹åŒ–é€Ÿåº¦ã€‚")]),s("div",{staticClass:"btn",staticStyle:{"margin-top":"20px"}},[s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.clearLocalStorage("paotuannote-")}}},[e._v("æ¸…é™¤æ‰€æœ‰ã€é‡è¦ç¬”è®°ã€‘ç¼“å­˜")])],1),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.clearLocalStorage("paotuanlog-")}}},[e._v("æ¸…é™¤æ‰€æœ‰ã€Log å½•åˆ¶ã€‘ç¼“å­˜")])],1),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.clearLocalStorage("paotuancard-")}}},[e._v("æ¸…é™¤æ‰€æœ‰ã€äººç‰©å¡ã€‘ç¼“å­˜")])],1)])])},No=[],Uo={props:["visible"],methods:{clearLocalStorage(e){const t=[],s=localStorage.length;for(let r=0;r<s;r++){const s=localStorage.key(r);s.startsWith(e)&&t.push(s)}t.forEach(e=>localStorage.removeItem(e)),this.$store.commit("showMessage",{type:"success",message:"æ¸…é™¤ç¼“å­˜æˆåŠŸ"})}}},Bo=Uo,Yo=(s("7028"),Object(d["a"])(Bo,Ro,No,!1,null,"1631b65b",null)),Fo=Yo.exports;function Vo(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function qo(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Vo(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Vo(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const Ho={CONVERSATION_LIST:"conversation-list",GROUP_LIST:"group-list",FRIEND_LIST:"friend-list",BLACK_LIST:"black-list"};var Ko={name:"SideBar",components:{ConversationList:Ui,GroupList:co,FriendList:Po,BlackList:Lo,GlobalSetting:Fo},data(){return{active:Ho.CONVERSATION_LIST,activeName:Ho,globalSettingsVisible:!1}},computed:qo(qo(qo({},Object(y["mapGetters"])(["totalUnreadCount"])),Object(y["mapState"])({userID:e=>e.user.userID})),{},{showConversationList(){return this.active===Ho.CONVERSATION_LIST},showGroupList(){return this.active===Ho.GROUP_LIST},showFriendList(){return this.active===Ho.FRIEND_LIST},showBlackList(){return this.active===Ho.BLACK_LIST},showAddButton(){return[Ho.CONVERSATION_LIST,Ho.GROUP_LIST].includes(this.active)}}),methods:{checkoutActive(e){this.active=e},handleClick(e){switch(e.target.id){case Ho.CONVERSATION_LIST:this.checkoutActive(Ho.CONVERSATION_LIST);break;case Ho.GROUP_LIST:this.checkoutActive(Ho.GROUP_LIST);break;case Ho.FRIEND_LIST:this.checkoutActive(Ho.FRIEND_LIST);break;case Ho.BLACK_LIST:this.checkoutActive(Ho.BLACK_LIST);break}},handleRefresh(){switch(this.active){case Ho.CONVERSATION_LIST:this.tim.getConversationList().catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})});break;case Ho.GROUP_LIST:this.getGroupList();break;case Ho.FRIEND_LIST:this.getFriendList();break;case Ho.BLACK_LIST:this.$store.dispatch("getBlacklist");break}},getGroupList(){this.tim.getGroupList().then(({data:e})=>{this.$store.dispatch("updateGroupList",e)}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},getFriendList(){this.tim.getFriendList().then(({data:e})=>{this.$store.commit("upadteFriendList",e)}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})})},handleExit(){this.$confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ").then(()=>{this.$store.dispatch("logout"),Cs()})}}},zo=Ko,Jo=(s("2612"),Object(d["a"])(zo,Pi,_i,!1,null,"3457d13e",null)),Qo=Jo.exports,Wo=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"profile-container"},[s("my-profile"),s("div",{staticClass:"base-info"},[s("div",{staticClass:"nick"},[e._v(e._s(e.currentUserProfile.nick||e.currentUserProfile.userID))]),s("div",{staticClass:"uid"},[e._v(e._s(e.currentUserProfile.userID))])]),s("div",{staticClass:"header-bar"},[s("button",{attrs:{title:"åˆ·æ–°åˆ—è¡¨"},on:{click:e.handleRefresh}},[s("i",{staticClass:"tim-icon-refresh"})]),s("el-dropdown",{on:{command:e.handleCreateChat}},[s("button",{staticClass:"btn2",attrs:{title:"åˆ›å»ºä¼šè¯"}},[s("i",{staticClass:"tim-icon-add"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"group"}},[e._v("åˆ›å»ºç¾¤èŠ")]),s("el-dropdown-item",{attrs:{command:"c2c"}},[e._v("å‘èµ·å•èŠ")])],1)],1)],1),s("div",{staticClass:"appid-prefix"},[e._v("PID "+e._s(e.currentAppid))]),s("el-dialog",{attrs:{title:"å‘èµ·ä¼šè¯",visible:e.showC2CDialog,width:"40%"},on:{"update:visible":function(t){e.showC2CDialog=t}}},[s("el-input",{attrs:{placeholder:"è¯·è¾“å…¥ç”¨æˆ·ID(QQå·)"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleCreateC2C(t)}},model:{value:e.userID,callback:function(t){e.userID=t},expression:"userID"}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.showC2CDialog=!1}}},[e._v("å– æ¶ˆ")]),s("el-button",{attrs:{type:"primary"},on:{click:e.handleCreateC2C}},[e._v("ç¡® å®š")])],1)],1),s("el-dialog",{attrs:{title:"åˆ›å»ºç¾¤ç»„",visible:e.createGroupModelVisible,width:"40%"},on:{close:function(t){return e.$store.commit("updateCreateGroupModelVisible",!1)}}},[s("create-group")],1)],1)},Zo=[],Xo=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"my-profile-wrapper"},[s("el-dialog",{attrs:{title:"ç¼–è¾‘ä¸ªäººèµ„æ–™",visible:e.showEditMyProfile,width:"40%"},on:{"update:visible":function(t){e.showEditMyProfile=t}}},[s("el-form",{attrs:{"label-width":"60px"},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[s("el-form-item",{staticClass:"avatar-edit",attrs:{label:"å¤´åƒ"}},[s("el-input",{attrs:{placeholder:"å¤´åƒåœ°å€(URL)"},model:{value:e.form.avatar,callback:function(t){e.$set(e.form,"avatar",t)},expression:"form.avatar"}}),s("el-button",{attrs:{type:"primary"},on:{click:e.useQQAvatar}},[e._v("ä½¿ç”¨æˆ‘çš„QQå¤´åƒ")])],1),s("el-form-item",{attrs:{label:"æ˜µç§°"}},[s("el-input",{attrs:{placeholder:"æ˜µç§°"},model:{value:e.form.nick,callback:function(t){e.$set(e.form,"nick",t)},expression:"form.nick"}})],1),s("el-form-item",{attrs:{label:"æ€§åˆ«"}},[s("el-radio-group",{model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[s("el-radio",{attrs:{label:e.TIM.TYPES.GENDER_MALE}},[e._v("ç”·")]),s("el-radio",{attrs:{label:e.TIM.TYPES.GENDER_FEMALE}},[e._v("å¥³")]),s("el-radio",{attrs:{label:e.TIM.TYPES.GENDER_UNKNOWN}},[e._v("ä¸æ˜¾ç¤º")])],1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.showEditMyProfile=!1}}},[e._v("å– æ¶ˆ")]),s("el-button",{attrs:{type:"primary"},on:{click:e.editMyProfile}},[e._v("ç¡® å®š")])],1)],1),s("div",{on:{click:e.handleEdit}},[s("avatar",{staticClass:"my-avatar",attrs:{src:e.currentUserProfile.avatar}})],1)],1)},en=[],tn=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"profile-card-wrapper"},[s("div",{staticClass:"content"},[s("avatar",{attrs:{src:e.profile.avatar}}),s("div",{staticClass:"basic"},[s("span",{staticClass:"nick text-ellipsis"},[e._v(e._s(e.profile.nick||e.profile.userID))]),s("span",{staticClass:"iconfont",class:e.genderClass})])],1)])},sn=[],rn={name:"ProfileCard",props:{profile:{type:Object,required:!0}},computed:{genderClass(){switch(this.profile.gender){case this.TIM.TYPES.GENDER_MALE:return"icon-male";case this.TIM.TYPES.GENDER_FEMALE:return"icon-female";default:return"æš‚æ— "}}}},on=rn,nn=(s("8127"),Object(d["a"])(on,tn,sn,!1,null,null,null)),an=nn.exports;function cn(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function ln(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?cn(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):cn(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var un={name:"MyProfile",components:{ElPopover:o["Popover"],ProfileCard:an,ElForm:o["Form"],ElFormItem:o["FormItem"],ElRadioGroup:o["RadioGroup"],ElRadio:o["Radio"]},data(){return{showEditMyProfile:!1,form:{avatar:"",nick:"",gender:""}}},computed:ln(ln({},Object(y["mapState"])({currentUserId:e=>e.user.userID,currentUserProfile:e=>e.user.currentUserProfile,currentConversation:e=>e.conversation.currentConversation})),{},{gender(){switch(this.currentUserProfile.gender){case this.TIM.TYPES.GENDER_MALE:return"ç”·";case this.TIM.TYPES.GENDER_FEMALE:return"å¥³";default:return"æš‚æ— "}}}),methods:{editMyProfile(){if(this.form.avatar&&-1===this.form.avatar.indexOf("http"))return this.$store.commit("showMessage",{message:"å¤´åƒåº”è¯¥æ˜¯ Url åœ°å€",type:"warning"}),void(this.form.avatar="");const e={};Object.keys(this.form).forEach(t=>{this.form[t]&&(e[t]=this.form[t])}),this.tim.updateMyProfile(e).then(()=>{this.$store.commit("showMessage",{message:"ä¿®æ”¹æˆåŠŸ"}),this.showEditMyProfile=!1}).catch(e=>{this.$store.commit("showMessage",{message:e.message,type:"error"})})},handleEdit(){const{avatar:e,nick:t,gender:s}=this.currentUserProfile;Object.assign(this.form,{avatar:e,nick:t,gender:s}),this.showEditMyProfile=!0},useQQAvatar(){this.form.avatar=`https://q.qlogo.cn/g?b=qq&nk=${this.currentUserId}&s=100`}}},pn=un,mn=(s("96b9"),Object(d["a"])(pn,Xo,en,!1,null,"680fcfff",null)),dn=mn.exports;function hn(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function gn(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):hn(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var fn={components:{MyProfile:dn,CreateGroup:Qi},data(){return{showC2CDialog:!1,userID:"",timeout:null}},computed:gn({},Object(y["mapState"])({currentUserId:e=>e.user.userID,currentAppid:e=>e.user.sdkAppID,currentUserProfile:e=>e.user.currentUserProfile,createGroupModelVisible:e=>e.group.createGroupModelVisible})),methods:{handleRefresh(){this.refreshConversation()()},refreshConversation(){let e=this;return function(){e.timeout||(e.timeout=setTimeout(()=>{e.timeout=null,e.tim.getConversationList().then(()=>{e.$store.commit("showMessage",{message:"åˆ·æ–°æˆåŠŸ",type:"success"})})},1e3))}},handleCreateChat(e){"c2c"===e?this.showC2CDialog=!0:this.$store.commit("updateCreateGroupModelVisible",!0)},handleCreateC2C(){"@TIM#SYSTEM"!==this.userID?this.$store.dispatch("checkoutConversation","C2C"+this.userID).then(()=>{this.showC2CDialog=!1}).catch(()=>{this.$store.commit("showMessage",{message:"æ²¡æœ‰æ‰¾åˆ°è¯¥ç”¨æˆ·",type:"warning"})}):this.$store.commit("showMessage",{message:"æ²¡æœ‰æ‰¾åˆ°è¯¥ç”¨æˆ·",type:"warning"}),this.userID=""}}},bn=fn,vn=(s("985b"),Object(d["a"])(bn,Wo,Zo,!1,null,"0aa28a56",null)),yn=vn.exports,On=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login-wrapper"},[s("img",{staticClass:"logo",attrs:{src:e.logo}}),s("el-form",{ref:"login",staticStyle:{width:"100%"},attrs:{"label-position":"left","label-width":"80px",rules:e.rules,model:e.form},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}}},[s("el-form-item",{attrs:{label:"å¹³å°ID",prop:"appid"}},[s("el-input",{attrs:{placeholder:"è¯·è¾“å…¥å¹³å°ID",type:"text",clearable:""},model:{value:e.form.appid,callback:function(t){e.$set(e.form,"appid",t)},expression:"form.appid"}})],1),s("el-form-item",{attrs:{label:"Secret",prop:"secret"}},[s("el-input",{attrs:{placeholder:"è¯·è¾“å…¥secret","show-password":""},model:{value:e.form.secret,callback:function(t){e.$set(e.form,"secret",t)},expression:"form.secret"}})],1),s("el-form-item",{attrs:{label:"QQ",prop:"userID"}},[s("el-input",{attrs:{placeholder:"è¯·è¾“å…¥QQå·ï¼Œè¯·å‹¿å†’ç”¨",type:"text",clearable:""},model:{value:e.form.userID,callback:function(t){e.$set(e.form,"userID",t)},expression:"form.userID"}})],1)],1),s("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[s("el-checkbox",{model:{value:e.form.isRememberUin,callback:function(t){e.$set(e.form,"isRememberUin",t)},expression:"form.isRememberUin"}},[e._v("è®°ä½å¸å·")]),s("el-checkbox",{model:{value:e.form.isAutoLogin,callback:function(t){e.$set(e.form,"isAutoLogin",t)},expression:"form.isAutoLogin"}},[e._v("è‡ªåŠ¨ç™»å½•")])],1),s("el-button",{staticStyle:{width:"100%","margin-top":"6px"},attrs:{plain:"",type:"info"},on:{click:e.submit}},[e._v("ç™»å½•\n  ")]),s("a",{attrs:{href:"https://docs.qq.com/doc/DSW1TdXhhSmdpamRX",target:"_blank"}},[e._v("ä½¿ç”¨æŒ‡å—ä¸å¸¸è§é—®é¢˜")]),s("el-popover",{attrs:{trigger:"click"}},[s("img",{attrs:{src:e.minacode}}),s("a",{attrs:{slot:"reference",href:"#"},slot:"reference"},[e._v("å°ç¨‹åºç‰ˆæœ¬")])])],1)},Cn=[],wn=s("a1d8"),Pn=s.n(wn),_n=s("be65"),Mn=s.n(_n),In={name:"Login",components:{ElForm:o["Form"],ElFormItem:o["FormItem"],ElPopover:o["Popover"]},props:["initialAppid","initialSecret"],data(){const e=(e,t,s)=>{/^[0-9]{5,15}$/.test(t)?s():s(new Error("æ ¼å¼ä¸æ­£ç¡®"))};return{form:{appid:this.initialAppid,secret:this.initialSecret,userID:Mn.a.get("uin"),isRememberUin:!!Mn.a.get("uin"),isAutoLogin:"true"===Mn.a.get("autologin")},rules:{userID:[{required:!0,message:"è¯·è¾“å…¥ QQ",trigger:"blur"},{validator:e,trigger:"blur"}],appid:[{required:!0,message:"è¯·è¾“å…¥ APPID",trigger:"blur"}],secret:[{required:!0,message:"è¯·è¾“å…¥ secret",trigger:"blur"}]},logo:Pn.a,minacode:ks.a}},methods:{submit(){this.$refs["login"].validate(e=>{e&&this.$emit("submit",this.form)})}}},jn=In,Tn=(s("25f1"),Object(d["a"])(jn,On,Cn,!1,null,"ffd3440e",null)),En=Tn.exports,Sn=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.showPreviewer,expression:"showPreviewer"}],staticClass:"image-previewer-wrapper",on:{mousewheel:e.handleMouseWheel}},[s("div",{staticClass:"image-wrapper"},[s("img",{staticClass:"image-preview",style:{transform:"scale("+e.zoom+") rotate("+e.rotate+"deg)"},attrs:{src:e.previewUrl},on:{click:e.close}})]),s("i",{staticClass:"el-icon-close close-button",on:{click:e.close}}),s("i",{staticClass:"el-icon-back prev-button",on:{click:e.goPrev}}),s("i",{staticClass:"el-icon-right next-button",on:{click:e.goNext}}),s("div",{staticClass:"actions-bar"},[s("i",{staticClass:"el-icon-zoom-out",on:{click:e.zoomOut}}),s("i",{staticClass:"el-icon-zoom-in",on:{click:e.zoomIn}}),s("i",{staticClass:"el-icon-refresh-left",on:{click:e.rotateLeft}}),s("i",{staticClass:"el-icon-refresh-right",on:{click:e.rotateRight}}),s("span",{staticClass:"image-counter"},[e._v(e._s(e.index+1)+" / "+e._s(e.imgUrlList.length))])])])},Dn=[];function xn(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function kn(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):xn(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var An={name:"ImagePreviewer",data(){return{url:"",index:0,visible:!1,zoom:1,rotate:0,minZoom:.1}},computed:kn(kn({},Object(y["mapGetters"])(["imgUrlList"])),{},{showPreviewer(){return this.url.length>0&&this.visible},imageStyle(){return{transform:`scale(${this.zoom});`}},previewUrl(){return this.formatUrl(this.imgUrlList[this.index])}}),mounted(){this.$bus.$on("image-preview",this.handlePreview)},methods:{handlePreview({url:e}){this.url=e,this.index=this.imgUrlList.findIndex(t=>t===e),this.visible=!0},handleMouseWheel(e){e.wheelDelta>0?this.zoomIn():this.zoomOut()},zoomIn(){this.zoom+=.1},zoomOut(){this.zoom=this.zoom-.1>this.minZoom?this.zoom-.1:this.minZoom},close(){Object.assign(this,{zoom:1}),this.visible=!1},rotateLeft(){this.rotate-=90},rotateRight(){this.rotate+=90},goNext(){this.index=(this.index+1)%this.imgUrlList.length},goPrev(){this.index=this.index-1>=0?this.index-1:this.imgUrlList.length-1},formatUrl(e){return e?"//"===e.slice(0,2)?"https:"+e:e:""}}},Gn=An,$n=(s("2425"),Object(d["a"])(Gn,Sn,Dn,!1,null,"c65b876c",null)),Ln=$n.exports;function Rn(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function Nn(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Rn(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Un={title:"paotuan",data(){return{loading:!0,initialAppid:"",initialSecret:"",invitedGroup:""}},components:{Login:En,SideBar:Qo,CurrentConversation:wi,ImagePreviewer:Ln,ProfileBar:yn},computed:Nn({},Object(y["mapState"])({currentUserProfile:e=>e.user.currentUserProfile,currentConversation:e=>e.conversation.currentConversation,videoCall:e=>e.conversation.videoCall,audioCall:e=>e.conversation.audioCall,isLogin:e=>e.user.isLogin,isSDKReady:e=>e.user.isSDKReady,isBusy:e=>e.video.isBusy,userID:e=>e.user.userID,userSig:e=>e.user.userSig,sdkAppID:e=>e.user.sdkAppID})),mounted(){let e=new URLSearchParams(location.hash.startsWith("#/")?location.hash.substr(2):""),t=e.get("s")||Mn.a.get("s");this.invitedGroup=e.get("g")||"";let s=Mn.a.get("uin"),r="true"===Mn.a.get("autologin");try{[this.initialAppid,this.initialSecret]=atob(t).split("/").map((e,t)=>0===t?e:e.split("").reverse().join(""))}catch(i){console.log("invalid sig",t)}r&&this.initialAppid&&this.initialSecret&&s?this.doLogin({appid:this.initialAppid,secret:this.initialSecret,userID:s}):this.loading=!1,location.hash=""},methods:{initListener(){gs(this.tim,{[this.TIM.EVENT.SDK_READY]:this.onReadyStateUpdate,[this.TIM.EVENT.SDK_NOT_READY]:this.onReadyStateUpdate,[this.TIM.EVENT.KICKED_OUT]:this.onKickOut,[this.TIM.EVENT.ERROR]:this.onError,[this.TIM.EVENT.MESSAGE_RECEIVED]:this.onReceiveMessage,[this.TIM.EVENT.CONVERSATION_LIST_UPDATED]:this.onUpdateConversationList,[this.TIM.EVENT.GROUP_LIST_UPDATED]:this.onUpdateGroupList,[this.TIM.EVENT.NET_STATE_CHANGE]:this.onNetStateChange,[this.TIM.EVENT.MESSAGE_READ_BY_PEER]:this.onMessageReadByPeer},this)},onReceiveMessage({data:e}){this.handleAt(e),this.handleAddGroupTip(e),this.handleQuitGroupTip(e),this.$store.commit("pushCurrentMessageList",e),this.$store.dispatch("insertGameLogs",e),this.$store.dispatch("handleKPNote",e)},onError({data:e}){"Network Error"!==e.message&&this.$store.commit("showMessage",{message:e.message,type:"error"})},onMessageReadByPeer(){},onReadyStateUpdate({name:e}){const t=e===this.TIM.EVENT.SDK_READY;this.$store.commit("toggleIsSDKReady",t),t&&(this.tim.getMyProfile().then(({data:e})=>{this.$store.commit("updateCurrentUserProfile",e)}).catch(e=>{this.$store.commit("showMessage",{type:"error",message:e.message})}),this.$store.dispatch("getBlacklist"),this.invitedGroup?this.tim.joinGroup({groupID:"@TGS#"+this.invitedGroup}).then(()=>{this.$store.commit("showMessage",{type:"success",message:"é‚€è¯·å…¥ç¾¤æˆåŠŸ"})}).catch(e=>{console.log("invited failed",e),this.$store.commit("showMessage",{type:"error",message:"é‚€è¯·å…¥ç¾¤å¤±è´¥"})}).finally(()=>{this.loading=!1}):this.loading=!1)},kickedOutReason(e){switch(e){case this.TIM.TYPES.KICKED_OUT_MULT_ACCOUNT:return"ç”±äºå¤šå®ä¾‹ç™»å½•";case this.TIM.TYPES.KICKED_OUT_MULT_DEVICE:return"ç”±äºå¤šè®¾å¤‡ç™»å½•";case this.TIM.TYPES.KICKED_OUT_USERSIG_EXPIRED:return"ç”±äº userSig è¿‡æœŸ";default:return""}},checkoutNetState(e){switch(e){case this.TIM.TYPES.NET_STATE_CONNECTED:return{message:"å·²æ¥å…¥ç½‘ç»œ",type:"success"};case this.TIM.TYPES.NET_STATE_CONNECTING:return{message:"å½“å‰ç½‘ç»œä¸ç¨³å®š",type:"warning"};case this.TIM.TYPES.NET_STATE_DISCONNECTED:return{message:"å½“å‰ç½‘ç»œä¸å¯ç”¨",type:"error"};default:return""}},onNetStateChange(e){this.$store.commit("showMessage",this.checkoutNetState(e.data.state))},onKickOut(e){this.$store.commit("showMessage",{message:this.kickedOutReason(e.data.type)+"è¢«è¸¢å‡ºï¼Œè¯·é‡æ–°ç™»å½•ã€‚",type:"error"}),this.$store.commit("reset"),Cs()},onUpdateConversationList(e){this.$store.commit("updateConversationList",e.data)},onUpdateGroupList(e){this.$store.commit("updateGroupList",e.data)},onReceiveGroupSystemNotice(e){const t=4===e.data.type,s="GROUP"+e.data.message.payload.groupProfile.groupID===this.currentConversation.conversationID;t&&s&&this.$store.commit("resetCurrentConversation"),Object(o["Notification"])({title:"æ–°ç³»ç»Ÿé€šçŸ¥",message:Pt(e.data.message),duration:3e3,onClick:()=>{const e="@TIM#SYSTEM";this.$store.dispatch("checkoutConversation",e)}})},handleAt(e){const t=e.filter(e=>e.type===this.TIM.TYPES.MSG_TEXT&&e.payload.text.includes("@"));for(let s=0;s<t.length;s++){const e=t[s],r=e.payload.text.match(/@\w+/g);r&&(r.includes("@"+this.currentUserProfile.userID)&&(this.$store.getters.hidden&&this.notifyMe(e),Object(o["Notification"])({title:`æœ‰äººåœ¨ç¾¤${e.conversationID.slice(5)}æåˆ°äº†ä½ `,message:e.payload.text,duration:3e3}),this.$bus.$emit("new-messsage-at-me",{data:{conversationID:e.conversationID}})))}},selectConversation(e){e!==this.currentConversation.conversationID&&this.$store.dispatch("checkoutConversation",e)},isJsonStr(e){try{return JSON.parse(e),!0}catch(t){return!1}},notifyMe(e){"Notification"in window&&("granted"===window.Notification.permission?this.handleNotify(e):"denied"!==window.Notification.permission&&window.Notification.requestPermission().then(t=>{"granted"===t&&this.handleNotify(e)}))},handleNotify(e){const t=new window.Notification("æœ‰äººæåˆ°äº†ä½ ",{icon:"https://webim-1252463788.file.myqcloud.com/demo/img/logo.dc3be0d4.png",body:e.payload.text});t.onclick=()=>{window.focus(),this.$store.dispatch("checkoutConversation",e.conversationID),t.close()}},handleAddGroupTip(e){const t=e.filter(e=>this.currentConversation.conversationID===e.conversationID&&e.type===this.TIM.TYPES.MSG_GRP_TIP&&e.payload.operationType===this.TIM.TYPES.GRP_TIP_MBR_JOIN);t.length>0&&this.$store.dispatch("getGroupMemberList",this.currentConversation.conversationID.replace("GROUP",""))},handleQuitGroupTip(e){const t=e.filter(e=>this.currentConversation.conversationID===e.conversationID&&e.type===this.TIM.TYPES.MSG_GRP_TIP&&(e.payload.operationType===this.TIM.TYPES.GRP_TIP_MBR_QUIT||e.payload.operationType===this.TIM.TYPES.GRP_TIP_MBR_KICKED_OUT));t.length>0&&t.forEach(e=>{(Array.isArray(e.payload.userIDList)||e.payload.userIDList.length>0)&&this.$store.commit("deleteGroupMemberList",e.payload.userIDList)})},doLogin({appid:e,secret:t,userID:s,isRememberUin:r=!0,isAutoLogin:i=!0}){ds(e,t),this.initListener();const o=Number(e);if(o>0){this.loading=!0;const n=window.genTestUserSig(s,o,t).userSig;this.tim.login({userID:s,userSig:n}).then(()=>{this.$store.commit("toggleIsLogin",!0),this.$store.commit("startComputeCurrent"),this.$store.commit({type:"GET_USER_INFO",userID:s,userSig:n,sdkAppID:e}),this.$store.commit("showMessage",{type:"success",message:"ç™»å½•æˆåŠŸ"}),Mn.a.set("s",btoa(e+"/"+t.split("").reverse().join("")),{expires:7}),Mn.a.set("autologin",i),r?Mn.a.set("uin",s,{expires:7}):Mn.a.remove("uin")}).catch(e=>{this.loading=!1,this.$store.commit("showMessage",{message:"ç™»å½•å¤±è´¥ï¼š"+e.message,type:"error"})})}else this.$store.commit("showMessage",{message:"ç™»å½•å¤±è´¥ï¼šå‚æ•°ä¸åˆæ³•",type:"error"})}}},Bn=Un,Yn=(s("2747"),s("f849"),Object(d["a"])(Bn,f,b,!1,null,"4d1525ca",null)),Fn=Yn.exports;s("386d");function Vn(e){const t=e>0;t?document.title.search(/\((.*?)\)/)>=0?document.title=document.title.replace(/\((.*?)\)/,`(${e>99?"99+":e})`):document.title=`(${e})${document.title}`:document.title=document.title.replace(/\((.*?)\)/,"")}const qn={state:{currentConversation:{},currentMessageList:[],nextReqMessageID:"",isCompleted:!1,conversationList:[],callingInfo:{memberList:[],type:"C2C"},audioCall:!1},getters:{toAccount:e=>{if(!e.currentConversation||!e.currentConversation.conversationID)return"";switch(e.currentConversation.type){case"C2C":return e.currentConversation.conversationID.replace("C2C","");case"GROUP":return e.currentConversation.conversationID.replace("GROUP","");default:return e.currentConversation.conversationID}},currentConversationType:e=>e.currentConversation&&e.currentConversation.type?e.currentConversation.type:"",totalUnreadCount:e=>{const t=e.conversationList.reduce((t,s)=>la.getters.hidden||e.currentConversation.conversationID!==s.conversationID?t+s.unreadCount:t,0);return Vn(t),t},imgUrlList:e=>e.currentMessageList.filter(e=>e.type===ts.TYPES.MSG_IMAGE&&!e.isRevoked).map(e=>e.payload.imageInfoArray[0].url)},mutations:{setCallingList(e,t){e.callingInfo.memberList=t.memberList,e.callingInfo.type=t.type},showAudioCall(e,t){e.audioCall=t},updateCurrentConversation(e,t){e.currentConversation=t,e.currentMessageList=[],e.nextReqMessageID="",e.isCompleted=!1},updateConversationList(e,t){e.conversationList=t},resetCurrentConversation(e){e.currentConversation={}},pushCurrentMessageList(e,t){if(e.currentConversation.conversationID)if(Array.isArray(t)){const s=t.filter(t=>t.conversationID===e.currentConversation.conversationID);e.currentMessageList=[...e.currentMessageList,...s]}else t.conversationID===e.currentConversation.conversationID&&(e.currentMessageList=[...e.currentMessageList,t])},removeMessage(e,t){const s=e.currentMessageList.findIndex(({ID:e})=>e===t.ID);s>=0&&e.currentMessageList.splice(s,1)},reset(e){Object.assign(e,{currentConversation:{},currentMessageList:[],nextReqMessageID:"",isCompleted:!1,conversationList:[]})}},actions:{getMessageList(e,t){if(e.state.isCompleted)return void e.commit("showMessage",{message:"å·²ç»æ²¡æœ‰æ›´å¤šçš„å†å²æ¶ˆæ¯äº†å“¦",type:"info"});const{nextReqMessageID:s,currentMessageList:r}=e.state;ms.getMessageList({conversationID:t,nextReqMessageID:s,count:15}).then(t=>{e.state.nextReqMessageID=t.data.nextReqMessageID,e.state.isCompleted=t.data.isCompleted,e.state.currentMessageList=[...t.data.messageList,...r]})},checkoutConversation(e,t){if(e.commit("resetCurrentMemberList"),e.state.currentConversation.conversationID){const t=e.state.currentConversation.conversationID;ms.setMessageRead({conversationID:t})}return ms.setMessageRead({conversationID:t}),ms.getConversationProfile(t).then(({data:s})=>(e.commit("updateCurrentConversation",s.conversation),e.dispatch("getMessageList",t),s.conversation.type===ts.TYPES.CONV_GROUP?(e.dispatch("initGame",s.conversation.groupProfile.groupID),e.dispatch("getGroupMemberList",s.conversation.groupProfile.groupID)):Promise.resolve()))}}};var Hn=qn;const Kn={state:{groupList:[],currentMemberList:[],createGroupModelVisible:!1},getters:{hasGroupList:e=>e.groupList.length>0},mutations:{updateGroupList(e,t){e.groupList=t},updateCreateGroupModelVisible(e,t){e.createGroupModelVisible=t},updateCurrentMemberList(e,t){e.currentMemberList=t},deleteGroupMemeber(e,t){e.currentMemberList=e.currentMemberList.filter(e=>e.userID!==t)},deleteGroupMemberList(e,t){e.currentMemberList=e.currentMemberList.filter(e=>!t.includes(e.userID))},resetCurrentMemberList(e){e.currentMemberList=[]},reset(e){Object.assign(e,{groupList:[],currentMemberList:[],createGroupModelVisible:!1})}},actions:{updateGroupList(e,t){e.commit("updateGroupList",t)},getGroupMemberList(e,t){return ms.getGroupMemberList({groupID:t,offset:0,count:30}).then(t=>(e.commit("updateCurrentMemberList",t.data.memberList),t))}}};var zn=Kn;const Jn={state:{currentUserProfile:{},isLogin:!1,isSDKReady:!1,userID:0,userSig:"",sdkAppID:0},mutations:{updateCurrentUserProfile(e,t){e.currentUserProfile=t},toggleIsLogin(e,t){e.isLogin="undefined"===typeof t?!e.isLogin:t},toggleIsSDKReady(e,t){e.isSDKReady="undefined"===typeof t?!e.isSDKReady:t},reset(e){Object.assign(e,{currentUserProfile:{},isLogin:!1,isSDKReady:!1})},GET_USER_INFO(e,t){e.userID=t.userID,e.userSig=t.userSig,e.sdkAppID=t.sdkAppID}},actions:{logout(e){e.rootState.conversation.currentConversation.conversationID&&ms.setMessageRead({conversationID:e.rootState.conversation.currentConversation.conversationID}),ms.logout().then(()=>{e.commit("stopComputeCurrent"),e.commit("reset")})}}};var Qn=Jn;const Wn={state:{friendList:[],createGroupModelVisible:!1},mutations:{upadteFriendList(e,t){e.friendList=t},reset(e){Object.assign(e,{friendList:[],createGroupModelVisible:!1})}}};var Zn=Wn;const Xn={state:{blacklist:[]},mutations:{updateBlacklist(e,t){e.blacklist=t},removeFromBlacklist(e,t){e.blacklist=e.blacklist.filter(e=>e.userID!==t)},reset(e){Object.assign(e,{blacklist:[]})}},actions:{getBlacklist(e){ms.getBlacklist().then(({data:t})=>{t.length>0&&ms.getUserProfile({userIDList:t}).then(({data:t})=>{e.commit("updateBlacklist",t)})})}}};var ea=Xn;s("6b54");function ta(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function sa(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ta(Object(s),!0).forEach((function(t){Object(v["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ta(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const ra={currentTab:"group",botEnabled:!1,logEnabled:!1,logs:[],bgm:{},notes:[],noteUnread:!1,cards:{},openedCards:["group","note","log"]},ia=e=>(aa.state.list[e]||i.a.set(aa.state.list,e,JSON.parse(JSON.stringify(ra))),aa.state.list[e]),oa=(e,t,s)=>{localStorage.setItem(`paotuan${e}-${t}`,JSON.stringify(s))},na=(e,t)=>{const s=localStorage.getItem(`paotuan${e}-${t}`);return s?JSON.parse(s):[]},aa={state:{list:{}},mutations:{initGame(e,t){i.a.set(e.list,t,JSON.parse(JSON.stringify(ra))),e.list[t].notes=na("note",t),e.list[t].logs=na("log",t),e.list[t].cards=na("card",t)},toggleBotEnabled(e,{groupId:t,enabled:s}){ia(t).botEnabled=s},toggleLogEnabled(e,{groupId:t,enabled:s}){ia(t).logEnabled=s},insertLog(e,{groupId:t,log:s}){ia(t).logs.push(s),oa("log",t,ia(t).logs)},updateLogs(e,{groupId:t,logs:s}){ia(t).logs=s,oa("log",t,s)},setGameBgm(e,{groupId:t,bgm:s}){ia(t).bgm=s},addNote(e,{groupId:t,note:s}){ia(t).notes.push(s),oa("note",t,ia(t).notes)},updateNotes(e,{groupId:t,notes:s}){ia(t).notes=s,oa("note",t,s)},setNoteUnread(e,{groupId:t,unread:s}){ia(t).noteUnread=s},setCurrentTab(e,{groupId:t,tab:s}){ia(t).currentTab=s},setUserCard(e,{groupId:t,userId:s,card:r}){i.a.set(ia(t).cards,"o"+s,r),oa("card",t,sa(sa({},ia(t).cards),{},{["o"+s]:r}))},setOpenedUserCards(e,{groupId:t,list:s}){ia(t).openedCards=s},reset(e){Object.assign(e,{list:{}})}},actions:{initGame(e,t){e.state.list[t]||e.commit("initGame",t)},toggleBotEnabled(e,{groupId:t,enabled:s}){return new Promise((r,i)=>{(s?vs:ys)(t).then(()=>{e.commit("toggleBotEnabled",{groupId:t,enabled:s}),r()}).catch(o=>{o.toString().includes("è¢«é‚€è¯·åŠ å…¥çš„ç”¨æˆ·å·²ç»æ˜¯ç¾¤æˆå‘˜")?(console.log("[bot.switch]already in group"),e.commit("toggleBotEnabled",{groupId:t,enabled:s}),r()):i(o)})})},insertGameLogs(e,t){t.filter(t=>t.conversationType===ts.TYPES.CONV_GROUP&&t.type===ts.TYPES.MSG_TEXT&&e.state.list[t.to]&&e.state.list[t.to].logEnabled).forEach(t=>{const s={id:t.ID,from:t.from,nick:t.nameCard||t.nick,time:t.time,content:t.payload.text};s.content.startsWith(".")||s.content.startsWith("ã€‚")||e.commit("insertLog",{groupId:t.to,log:s})})},handleKPNote(e,t){t.filter(e=>e.conversationType===ts.TYPES.CONV_GROUP&&e.priority===ts.TYPES.MSG_PRIORITY_HIGH).forEach(t=>{if(t.type===ts.TYPES.MSG_CUSTOM){const s=JSON.parse(t.payload.data);"bgm"===s.mtype?(e.commit("setGameBgm",{groupId:t.to,bgm:s.mdata}),e.dispatch("handleNoteUnread",t.to)):"card"===s.mtype&&e.commit("setUserCard",{groupId:t.to,userId:s.mdata.userId,card:s.mdata.card})}else t.type===ts.TYPES.MSG_TEXT?(e.commit("addNote",{groupId:t.to,note:{id:t.ID,type:t.type,payload:t.payload.text}}),e.dispatch("handleNoteUnread",t.to)):t.type===ts.TYPES.MSG_IMAGE&&(e.commit("addNote",{groupId:t.to,note:{id:t.ID,type:t.type,payload:t.payload.imageInfoArray[0].imageUrl}}),e.dispatch("handleNoteUnread",t.to))})},handleNoteUnread(e,t){"note"!==ia(t).currentTab&&e.commit("setNoteUnread",{groupId:t,unread:!0})},openUserCard(e,{groupId:t,userId:s}){const r=ia(t);return r.cards["o"+s]?(r.openedCards.includes(s)||e.commit("setOpenedUserCards",{groupId:t,list:[...r.openedCards,s]}),e.commit("setCurrentTab",{groupId:t,tab:s}),new Promise(e=>e())):new Promise((e,t)=>t())},closeUserCard(e,{groupId:t,userId:s}){const r=ia(t);e.commit("setOpenedUserCards",{groupId:t,list:r.openedCards.filter(e=>e!==s)}),r.currentTab===s&&e.commit("setCurrentTab",{groupId:t,tab:"group"})}}};var ca=aa;i.a.use(O.a);var la=new O.a.Store({state:{current:Date.now(),intervalID:0,message:void 0},getters:{hidden(e){e.current;return"function"!==typeof document.hasFocus?document.hidden:!document.hasFocus()}},mutations:{startComputeCurrent(e){e.intervalID=setInterval(()=>{e.current=Date.now()},500)},stopComputeCurrent(e){clearInterval(e.intervalID),e.intervalID=0},showMessage(e,t){e.message&&e.message.close(),e.message=Object(o["Message"])({message:t.message,type:t.type||"success",duration:t.duration||2e3,offset:40})}},modules:{conversation:Hn,group:zn,friend:Zn,blacklist:ea,user:Qn,game:ca}}),ua=s("018c"),pa=s.n(ua);s("ed2c"),s("8e84");i.a.prototype.$bus=new i.a,i.a.prototype.tim=ms,i.a.prototype.TIM=ts,i.a.prototype.$store=la,i.a.use(n.a),i.a.use(pa.a),i.a.component("avatar",g),new i.a({render:e=>e(Fn)}).$mount("#app")},5880:function(e,t){e.exports=Vuex},"5bcc":function(e,t,s){},"5f5c":function(e,t){e.exports=XLSX},"5f72":function(e,t){e.exports=ELEMENT},6044:function(e,t,s){},"691c":function(e,t,s){"use strict";s("5406")},"69cc":function(e,t,s){"use strict";s("e5a1")},"6d42":function(e,t,s){},7028:function(e,t,s){"use strict";s("9290")},"76e5":function(e,t,s){},"777c":function(e,t,s){"use strict";s("c1f9")},"78e0":function(e,t,s){},7982:function(e,t,s){},"7a62":function(e,t,s){},"7ba6":function(e,t,s){"use strict";s("5bcc")},"7f69":function(e,t,s){"use strict";s("eca0")},8127:function(e,t,s){"use strict";s("12d4")},"824b":function(e,t,s){},"831a":function(e,t,s){"use strict";s("12a8")},"852a":function(e,t,s){},"854e":function(e,t,s){},8674:function(e,t,s){"use strict";s("78e0")},"86b5":function(e,t,s){"use strict";s("b8dc")},"873f":function(e,t,s){"use strict";s("a396")},8810:function(e,t,s){"use strict";s("2158")},"8aaf":function(e,t,s){},"8bbf":function(e,t){e.exports=Vue},"8d6e":function(e,t,s){},"8e6d":function(e,t,s){"use strict";s("6d42")},"8e84":function(e,t,s){},"8f40":function(e,t,s){"use strict";s("8aaf")},9016:function(e,t,s){},9122:function(e,t,s){"use strict";s("7982")},9290:function(e,t,s){},"96b9":function(e,t,s){"use strict";s("a7a6")},"985b":function(e,t,s){"use strict";s("e292")},9908:function(e,t,s){},"9c8e":function(e,t,s){},a1d8:function(e,t,s){e.exports=s.p+"img/logo.7ea2a7d2.png"},a352:function(e,t){e.exports=Sortable},a396:function(e,t,s){},a65e:function(e,t,s){"use strict";s("e78d")},a7a6:function(e,t,s){},a86b:function(e,t,s){"use strict";s("854e")},b322:function(e,t,s){},b371:function(e,t,s){"use strict";s("5316")},b7a8:function(e,t,s){"use strict";s("c980")},b849:function(e,t,s){"use strict";s("fbe1")},b8dc:function(e,t,s){},bd2d:function(e,t){e.exports=math},be65:function(e,t){e.exports=Cookies},c16a:function(e,t,s){"use strict";s("9c8e")},c1f9:function(e,t,s){},c8ad:function(e,t,s){"use strict";s("852a")},c964:function(e,t,s){},c980:function(e,t,s){},d2b0:function(e,t,s){"use strict";s("4bf3")},d4e4:function(e,t,s){},daca:function(e,t,s){"use strict";s("d4e4")},e017:function(e,t,s){"use strict";s("76e5")},e292:function(e,t,s){},e3ec:function(e,t,s){"use strict";s("53b9")},e5a1:function(e,t,s){},e78d:function(e,t,s){},e8d4:function(e,t,s){},ec25:function(e,t,s){"use strict";s("6044")},eca0:function(e,t,s){},ed2c:function(e,t,s){},f6e3:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACpCAMAAAHy0MbyAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJYUExURQrBYAvBYRPDZhzGbCXIcSrJdSHHbxjFaQ7CYwzBYSnJdEzSi3bcpqLnw87z3+X47uj58Ov68uz68+n58ef579/36rzu05Djt2TYmz7OghnFai/KeIHfrcPw2OP47fz+/f////P8+Nb15K7ry1vVlBrFaw7CYlDTjqrqyPP899j15YrhsxDCZFfUksDv1vr+/C7KdyzKdq3qynLbo2HXmf7//rTszhTDZo/jtk7SjCjJc7nt0fX9+THLes3y3/3//oXgsA3CYjTMe5HjuA/CY8/z4IDfrRbEaLft0GbYnO779Pb9+cLv1x3GbNL04ub575zmv5flvEDPgzDLeaXoxIzitPD79TXMfB7GbeL47F7WlhLDZavqyfj9+03SjN326YvitEbQh3jdqO/79CLHcLHrzE/TjSPHcOT47vH79rHrzUvSivf9+vn++8zy3lXUkdf15SDHblnVk+D36ybIclrVlGfZnHjdpznNf1HTjhfEadv26I3itUfRiMfx26Pow0HPhJPkuZjlvMHv1zjNfkTQhWnZnhvFa8ry3TLLepXkurbt0Gvan4LfrknRiV/Wl9X05HHbo7/v1Z3mv8jx24jhskjRiTrNf8nx3Mvy3WLXmUfQh0XQhu3681LTj9n15ljVk2XYm6/ry+H37Or68bXsz2PYmjfMfW3aoLvu0zbMfTPLe77u1S7KeErRirDrzNr253fcpkPPhSvJdafpxr3u1N736n/frPL89o7itW/boWDXl3ndqJvmvvv+/Xveqsbx2tz26fT8+BHDZD3OgYTgr4fhsQAAAKRC35oAAADIdFJOU/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A9ppxxwAAAAlwSFlzAAAXEQAAFxEByibzPwAABVpJREFUaEPt2zuP2koUB3BaN1dCLikwols5fVb5Cim3QaxEtNomDdJKaHWbbaBASPcTUKVBShv6NNH6e2Uefxs/5u0H7NX5NXiOzwwjY+yxPR4N422MhYqEw/KFiDbiZ3UY0V7D1ThizDMiAmIcIkIURaycxlGEQCFLRvUvlDJ8/j+MP2OhTGymxoqxCDc2ioz6/mgo5hB1C39BtBZGkEFAQIiLERKiKN2xtc0ffpSkD1MsVhzxSZxgoydLlA2QKfyLmA7S4Buiaitk5RBWQ04BYTXkFBBWQ04BYTXkFA6IqyCl5AvWNGB9DVbWYW3NGWvVZGOZsb8X8i+MAiHe5rOFeYfMbcSuliQzlA3WSGUQ0fqGPAExHWRJvxFUwzk2h6gacnKIqiEnt0VYCTm5FcJKyMlVzrB1yMl9tFzTBn5ASgFxFWRc6I+YSCjDmoZGDzisq8PaKuWQR52qaTi/BKjB2jo28mZjb7k2TkRRLGv9lCcgTUdrkiQbpbZTVk5003VYH2X3lo4SQkiAN3EokhYbBNuqDFWkN6xqoTRWKmt5d2SJZhSQESQfAyohJwRa0ECSvzka0LhHmrcZGtBYI80b6usYR1kG7ARuRO1KH63d0D8GausFdfiAykbI9fAdNS0+Id2RU2cl1HCivHrQ8bgPihpuvqOSi/RxFRd4XSwyU1bEIndKUcVbym8fYplhBeNlswfWVIJuTXh35WIH7lhjvEHhAcEuRO9/ZKOrPSKEEEIIIVey+e+f8Wy8e3V4yuxuWb4AV02QCFO/rH9CvB3FLRPlbB5P6lsmWBnuBQ3VYXUwNNPg8NTPhA+o1Vr9eKb7UUgJUnt8WDFHTgDDXTkGSQHM97ncHt6ooAGN4NtctstZZHnbo74O0rxpHsgVkObtHvV1Qq+4be2G3hCndiVqV6J2pb7afUJ9HbcpYk316Xx15smAeqiuhzxPW9TWq8xQdmW9u+53J7VQ3Dc0CJgCa98KHJLd2c5tOaQ7QzUr46yoJpeNK3ndY85QyYXPcApV3KCOA9cfTZqglp1fu+7/utT9Z9NNoFJLj2s8nuBYZSxx1dKd919OTKxixLOiNC+OnnkJBdtUKzN+ALo8gub/byy2xVq6bMRKoR3WxekjllfsJw1+fl7H+pjEfHd65ztKV90did/q8hynw+lmomEIfi6mdEKr284nx02y7GlPU+4IIYQQQgghhBBisVxuNptOp4j0YpOt60/wF/MfN9nvHzt0UGH2OfTJUT9eTdMipPmt9Hhj2K4Vr6hwTYcFOuOiu3lUYZauWzZ31S3s90hD2F3vQKF4xdBudq3/3G90wFfoc+t2grYtN75Gf1/x5QEWaGJAL7YpBSah0w3C2SZWGI0HPzzoJ0+66GZ2rDuPV+tUWkyvDGKbvGOx7vbxn9UnfG+g1cDnirbdfUE7A6Hu9om62yfqbp+ou336YN1tMTjn4oFPwm5TR/U6m+flJOCKvSr8vZQA5ZlggQa8/jn7TMTU8ZpZ20ary7SLfMpiv9J2V2klsfuE3WBHfFcnMjTal32buwsKcfgbcQ463bRSfxeZ6Rpf0a2A9xtcTLo4fKn0soH3fAp6P/o4xfWw3+amPfzhetpzuR2+olv3fMp89+56HJ1F+4kCdpQTihVnuc/HB5TLDpOB75VJE9GjZKX6cow1Bx0xWkR4A+AB5ZIU58Gejq5hnnGUaxxCMdacnlC+EZP8qHwqvwyB/ZZF0xt7RSJdF4eN6Wl7PP7asoHmFNv2J5JuyVk3Wnu8yt/fKkq32Jwlq/tbflMmet/e/ZEdncZfj0Gvvw4s35ztXpkjhBBCCCGkrdHoLzv9X1u4OdoGAAAAAElFTkSuQmCC"},f849:function(e,t,s){"use strict";s("f955")},f955:function(e,t,s){},fbe1:function(e,t,s){},fc3e:function(e,t,s){},fd5d:function(e,t,s){},fe90:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAYAAAHfgQuIAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAOKADAAQAAAABAAAAOAAAAAAun0ppAAAG3UlEQVRoBdWav4tcVRTHJ667EIkiK1opDLFQEWxCUoQ0FissgnYWYhO2sVibNOIfsEGwNRbaWWxhUkQhVUBIsBDBRlglNltEFxYWIqwgwR/x+3n7vi9n7tz3Y+bNTJIDZ++5556f98e5d14yGIzCTXU/H2UNBvspQ/1h5H0cOiumMZWFx8W9VY7cSySOxT6Dxp/iwDB2cvSSmHdzAxcTZuXfhMN3SuYnekfdtcdKtqOM7cuMWT0OwP+NP4AFjnrj/YK/XgquWapsL5X8hD0YoJCmOiZUMqoImLTogQFPg5VTXqGcnWlr1LSe5wE5AD8IsVaH3hmFRxSA2Hmr7NtAIVD+iXKRX3kjb0LaFCJcrY/oWrigkQPhrvB0rVQYwPLt0IdcFsLfoZMDBpuAiRmTGWM0WKhkP5LQ8SC4F2iTkVelUlkopdI+7JT3R45Z6jc293zoGqVyg1HxfQkQUhNWNjzF2T1YSd0nLHcZFjP6YTn2lNo6j6XI6ESls/ZPMHDDGmrfFW6FfkGivJoyQ/9r0SN1NYwNNtTBwLbwGeFJIWsGj0oxEbCzUOyCnKi4Czs7ulo6uDOFARbIwZ1o82hHZ9sEO47/VTr3thlRIyoymjWwMbDNOlcAozrVFfeI8PTECpCIFN0mOU4g428jSfmkM29gBxd+2FmLcMhxKarUYSa1b8sgCKQPRtNPu8MthFEulQh9HKF7LRoT7UJQsOumdVqnnyXOzqs/lhTXJcz0zFCaujr+RLIpUBPRz5Y4KgODHNi+QMXG1kgBjjcUDv4UkuETQmfF+UzlxMqCpw7dV4XYei0r2cLkwHrRHUjaXpFMuvFazDYPs5v5MbIr5I3JRrsppHBk10f8iYGrxjs4zSjX5yqbGrxrMXxJ2DRdaxpnrR3EuujO4J2Ksh8fXZWZEW4cdLnqWmEoCUeZnsdW5SBwsbSzH3hjJA5wNosziHEu8cZMnRnCswJnOramG/KAQ27nWYPXdMQuzthlKayIsSdMfwBOIsdGwn51ZKgiMHLlC2eMgU3QJucjU9hwycoZJLMuDtvkOKfYWcIJxDbEnAE/lMHCIRHMG3BI7S0c8sCZN+CQulw4XJm3t9LPXe/M5xOHRNMXefmlsGeHb6YjM+h/lbFxHR6ZcDQiXFOnb4bRHlcb9rjEB1fKDrTBhXxap3wwisB9iq0C7P28GWXL23Jah4mpwk6xQz3AR6MqAjPV8sSb1ClfCiJwiWODmloBJQcmj9YUeNx2dVqUrmDAS7MTeBW5VRrmAZuDG2LmHPPpgm90ObB8bqzgeQrrnNYqZgZ4OeCQN1Ij2GluehsVy8FVtc5s2EUBGU8viunurbNBEfG9hx7rNxGwAbx7MUBx2BSeFFJ7KfhrQq42Z0S7IewFnFMXh2g40gTDy2FhQFA4vCz0CyIG1JVGFxvYwuYDA5aXpYpLHJMgUJb2A+EbQpadJWfpQegXhYwhsy2smxh84AufcwU2+ZYwJgJ9W8jB8c0qsjdgC5vYTv0Rw8QHTjq1MNSIS4+dUYIoJ4sCfPlTiGMgpmGfACi4MTEK8SwKep+Y0CUGXwokS4ytl4NkRiDdig9DYiMBqkNMXk1aYm4FDjIPASuyLWa631sjmEyAsxq3LrHXFiOeU7Eq8sx6VIBYvSjkMPI0JIll4YHQQlSwLhB/8Vq37TtAk90+9ojZMZALOVVwRZQHP6247cRe0LM+vGmhrz3/dCEWHgwFnNFfB8dlO5L5kUjt3xWNMOsEBkLDmxb62iP2+GA4TSBfCJ3gJoxHHMjB+ZBb8d3aDJ5UjzqQg/PZJRk+ypvRZ3th62EAcnA+xaegwxDVk4FOyd+Dog08qJZY6iDmcMhF+XOQPBXolPwmZTzAflMsMYcitwsK1Cux3RD0cxr7O8haZ9EtMTzbECc5OCZyK542sbSuNSi/E5RtZNEtMdQBsTsecqqebf6HAwb5DcbWrYMzGvhPaEOLavGJ7zogZmJ3PGOfNPhnEg8iOPaeE8+wLOK60PLzbvGFzzog1phc9U8+qcKGGA72jujVVCDpcxZm9V8m7De22G46b4RDjMRqPXJohHWNWpj2YqP0/cHXRX4vjLrT0NjAVhcgtuiD2DvBMUldFVqZX9BnO2neF+LD0nvCL4U3hL8KuXNBaHiMIYPsJEAs8Vc9sRLzxDCUxr7QidIya1MZk14fwGe6YsQ27GPUuidExBUlUfY9PzSPC+cF2MZHPGP4JhZimgusy+qOMK4qNFWM35LcRU0VT8NZQAddbMSKaD/4xPdCgRmmJB8IHcisWmxiGx9TwzzO0pKiOSU8J3xF+JLwBSGPYD+EXWxYqVvCX4TfCX8U/iucGfwPlkqurjfJdY8AAAAASUVORK5CYII="}});